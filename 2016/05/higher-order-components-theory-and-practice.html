
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Higher Order Components: Theory and Practice</title>
  <meta name="author" content="Alexander Beletsky">

  
  <meta name="description" content="Higher Order Components: Theory and Practice May 7th, 2016 react, redux What I enjoy the most working with React.js is its functional approach for &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://beletsky.net/2016/05/higher-order-components-theory-and-practice.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/fontello.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/pure-min.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/style.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Alexander Beletsky's development blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:800' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Roboto:300' rel='stylesheet' type='text/css'>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-16388698-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>


<body>
	<header class="pure-g-r"><div class="pure-g-r">
	<div class="inner pure-u-1">
		<h4 class="light">Alexander Beletsky's development blog</h4>
		<h1><a href="/">My profession is engineering</a></h1>
		<nav role="navigation" class="pure-menu pure-menu-open pure-menu-horizontal light"><ul>
	<li><a href="/projects">Projects</a></li>
	<li><a href="/talks">Talks</a></li>
	<li><a href="/medium">Medium</a></li>
	<li><a href="/blog/archives">Archive</a></li>
	<li><a href="/about">About me</a></li>
</ul>

</nav>
	</div>
</div>

</header>
	<div class="social inner pure-menu-horizontal"><ul>
	<li><a class="twitter icon-twitter" href="http://twitter.com/alexbeletsky"></a></li>
	<li><a class="github icon-github-circled" href="https://github.com/alexanderbeletsky"></a></li>
	<li><a class="stackoverflow icon-stackoverflow" href="http://stackoverflow.com/users/386751/alexanderb"></a></li>
	<li><a class="rss icon-rss" href="http://feeds.feedburner.com/abeletskyblog"></a></li>
</ul>
</div>
	<div id="content" class="inner pure-g-r"><article class="post">
	  
  <h1 class="title pure-u-1">Higher Order Components: Theory and Practice</h2>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2016-05-07T14:47:00+02:00" pubdate data-updated="true">May 7<span>th</span>, 2016</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/react/'>react</a>, <a class='category' href='/blog/categories/redux/'>redux</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <p>What I enjoy the most working with React.js is its <a href="http://engineering.blogfoster.com/the-functional-approach-to-ui/">functional approach</a> for building UI&rsquo;s. Everything you see on a screen is essentially a component. Components are <em>composed</em> of other components, making complex interfaces possible.</p>

<p>Higher-order components concept goes back to <a href="https://en.wikipedia.org/wiki/Higher-order_function">higher-order functions</a>, <em>functional programming</em> concept, describing the function that takes other function(s) and returns a function. In exactly the same way, higher-order component takes another component(s) and return a component.</p>

<p>Where might it be useful? Let’s consider a few practical cases.</p>

<!-- MORE -->


<h2>Authentication and Authorization</h2>

<p>Web applications have different areas, which are accessible depending on user’s authentication and access control.</p>

<p>There are <em>guest</em> routes, like <code>/signup</code>, <code>/signin</code>, <code>/forgot-password</code> etc, as well as <em>private</em> routes, <code>/dashboard</code>, <code>/user-profile</code> and so on.</p>

<p>For example,</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">const</span> <span class="nx">routes</span> <span class="o">=</span> <span class="p">(</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/signup&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">SignUp</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/signin&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">SignIn</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/welcome-on-board&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Welcome</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/forgot-password&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">ForgotPassword</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/signout&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">SignOut</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">App</span><span class="p">}</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;dashboard&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;dashboard&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Dashboard</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;profile&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;user-profile&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">UserProfile</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;*&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">FourOFour</span><span class="p">}</span> <span class="nx">status</span><span class="o">=</span><span class="p">{</span><span class="mi">404</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span><span class='line'><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>What we want to do: Everything under <code>/</code> URL is protected from unauthorized access.</p>

<p>One solution could be to extend <code>App</code> itself, with <code>componentDidMount</code> and <code>componentDidUpdate</code> and check if the user is authenticated. If not, redirect the user to <code>/signin</code>. It sounds right from the very beginning, but this solution has two drawbacks.</p>

<p>Firstly, it violates the <em>single responsibility</em> principle, what now mixes up functionality to <code>App</code> component, that originally doesn’t belong to it. And secondly, in case we want to introduce another route with similar behavior, that logic has to be present there as well, that would lead to some code duplications.</p>

<p>Let’s introduce a higher-order component for that,</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">PropTypes</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="p">{</span> <span class="nx">connect</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-redux&#39;</span><span class="p">;</span>
</span><span class='line'><span class="kr">import</span> <span class="p">{</span> <span class="nx">push</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-router-redux&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">requiresAuth</span><span class="p">(</span><span class="nx">Component</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kr">class</span> <span class="nx">AuthenticatedComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
</span><span class='line'>    <span class="kr">static</span> <span class="nx">propTypes</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">user</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">object</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">dispatch</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">.</span><span class="nx">isRequired</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_checkAndRedirect</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">componentDidUpdate</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_checkAndRedirect</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">_checkAndRedirect</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="kr">const</span> <span class="p">{</span> <span class="nx">dispatch</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">dispatch</span><span class="p">(</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;/signin&#39;</span><span class="p">));</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">(</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&quot;authenticated&quot;</span><span class="o">&gt;</span>
</span><span class='line'>          <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">user</span> <span class="o">?</span> <span class="o">&lt;</span><span class="nx">Component</span> <span class="p">{...</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">}</span> <span class="o">/&gt;</span> <span class="o">:</span> <span class="kc">null</span> <span class="p">}</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'>      <span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kr">const</span> <span class="nx">mapStateToProps</span> <span class="o">=</span> <span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">user</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">account</span><span class="p">.</span><span class="nx">user</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nx">connect</span><span class="p">(</span><span class="nx">mapStateToProps</span><span class="p">)(</span><span class="nx">AuthenticatedComponent</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>We are using Redux here, but in general, the concept doesn’t depend on Redux at all.</p>

<p>So, <code>requiresAuth</code> is a function that takes <code>Component</code> and returns <code>AuthenticatedComponent</code>. <code>AuthenticatedComponent</code> wraps the original component, plus it checks if the user already authenticated, in case he is not, it will redirect to <code>/signup</code>.</p>

<p>Updated routing,</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">const</span> <span class="nx">routes</span> <span class="o">=</span> <span class="p">(</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/signup&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">SignUp</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/signin&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">SignIn</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/welcome-on-board&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Welcome</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/forgot-password&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">ForgotPassword</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/signout&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">SignOut</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="cm">/* App component is wrapped with requiresAuth()  */</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/app&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">requiresAuth</span><span class="p">(</span><span class="nx">App</span><span class="p">)}</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;dashboard&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;dashboard&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Dashboard</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;profile&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;user-profile&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">UserProfile</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/config&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">requiresAuth</span><span class="p">(</span><span class="nx">Config</span><span class="p">)}</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;page&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;page&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">PageConfig</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;*&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">FourOFour</span><span class="p">}</span> <span class="nx">status</span><span class="o">=</span><span class="p">{</span><span class="mi">404</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span><span class='line'><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>By extending <code>requiresAuth</code> with additional parameters, it’s very easy to add some ACL functionality,</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/app&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">requiresAuth</span><span class="p">(</span><span class="nx">App</span><span class="p">,</span> <span class="p">{</span> <span class="nx">role</span><span class="o">:</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="nx">redirectTo</span><span class="o">:</span> <span class="s1">&#39;/signin&#39;</span> <span class="p">})}</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;dashboard&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;dashboard&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Dashboard</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;invoices&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;user-profile&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">UserProfile</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/config&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">requiresAuth</span><span class="p">(</span><span class="nx">Config</span><span class="p">,</span> <span class="p">{</span> <span class="nx">role</span><span class="o">:</span> <span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="nx">redirectTo</span><span class="o">:</span> <span class="s1">&#39;/app&#39;</span> <span class="p">})}</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;page&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;page&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">PageConfig</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, <code>_checkAndRedirect()</code> function is modified to take a role into account,</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">_checkAndRedirect</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kr">const</span> <span class="p">{</span> <span class="nx">dispatch</span><span class="p">,</span> <span class="nx">user</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
</span><span class='line'>  <span class="kr">const</span> <span class="p">{</span> <span class="nx">role</span><span class="p">,</span> <span class="nx">redirectTo</span> <span class="p">}</span>  <span class="o">=</span> <span class="nx">options</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">user</span> <span class="o">||</span> <span class="o">!</span><span class="nx">user</span><span class="p">.</span><span class="nx">role</span> <span class="o">===</span> <span class="nx">role</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">dispatch</span><span class="p">(</span><span class="nx">push</span><span class="p">(</span><span class="nx">redirectTo</span> <span class="o">||</span> <span class="s1">&#39;/signin&#39;</span><span class="p">));</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Redirections</h2>

<p>Another case is a redirection of a user. A redirect is forced for some users in specific conditions. For instance, we might want a user to complete some actions during his onboarding, and prevent access to a particular route, if these actions are not completed.</p>

<p>Otherwise, if onboarding is completed, we want to redirect a user to the dashboard.</p>

<p>To make it possible, we introduce <code>checkBoarding()</code> function and a corresponding <code>CompletedComponent</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">checkBoarded</span><span class="p">(</span><span class="nx">Component</span><span class="p">,</span> <span class="p">{</span> <span class="nx">withValue</span><span class="p">,</span> <span class="nx">redirectTo</span> <span class="p">})</span> <span class="p">{</span>
</span><span class='line'>  <span class="kr">class</span> <span class="nx">CompletedComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
</span><span class='line'>    <span class="kr">static</span> <span class="nx">propTypes</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">state</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">object</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">dispatch</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">.</span><span class="nx">isRequired</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_checkAndRedirect</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">componentDidUpdate</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_checkAndRedirect</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">_checkAndRedirect</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="kr">const</span> <span class="p">{</span> <span class="nx">dispatch</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_shouldRedirect</span><span class="p">())</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">dispatch</span><span class="p">(</span><span class="nx">push</span><span class="p">(</span><span class="nx">redirectTo</span><span class="p">));</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">_shouldRedirect</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">boarded</span> <span class="o">===</span> <span class="nx">withValue</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">(</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&quot;boarded&quot;</span><span class="o">&gt;</span>
</span><span class='line'>          <span class="p">{</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_shouldRedirect</span><span class="p">()</span> <span class="o">?</span> <span class="o">&lt;</span><span class="nx">Component</span> <span class="p">{...</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">}</span> <span class="o">/&gt;</span> <span class="o">:</span> <span class="kc">null</span> <span class="p">}</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'>      <span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kr">const</span> <span class="nx">mapStateToProps</span> <span class="o">=</span> <span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">state</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">account</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nx">connect</span><span class="p">(</span><span class="nx">mapStateToProps</span><span class="p">)(</span><span class="nx">CompletedComponent</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Routing,</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">const</span> <span class="nx">routes</span> <span class="o">=</span> <span class="p">(</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/signup&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">SignUp</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/signin&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">SignIn</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// applied here..</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/welcome-on-board&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">checkBoarded</span><span class="p">(</span><span class="nx">Welcome</span><span class="p">,</span> <span class="p">{</span> <span class="nx">withValue</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">redirectTo</span><span class="o">:</span> <span class="s1">&#39;/app/dashboard&#39;</span><span class="p">})</span> <span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/forgot-password&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">ForgotPassword</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/signout&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">SignOut</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// .. and here</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/app&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">checkBoarded</span><span class="p">(</span><span class="nx">requiresAuth</span><span class="p">(</span><span class="nx">App</span><span class="p">),</span> <span class="p">{</span> <span class="nx">withValue</span><span class="o">:</span> <span class="kc">false</span><span class="o">:</span> <span class="nx">redirectTo</span><span class="o">:</span> <span class="s1">&#39;/welcome-on-board&#39;</span> <span class="p">})}</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;dashboard&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;dashboard&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Dashboard</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;profile&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;user-profile&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">UserProfile</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/config&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">requiresAuth</span><span class="p">(</span><span class="nx">Config</span><span class="p">)}</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;page&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;page&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">PageConfig</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;*&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">FourOFour</span><span class="p">}</span> <span class="nx">status</span><span class="o">=</span><span class="p">{</span><span class="mi">404</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span><span class='line'><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Setting up context</h2>

<p>Some routes (or more typically, group of routes), require some data context. Say, <code>/website/1</code> and <code>/website/1/banners</code>, <code>/websites/1/revenues</code> all requires that website with <code>id:1</code> is loaded and available as part of the state.</p>

<p>Instead of loading the same data in each component, we might use higher-order component.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">websiteContext</span><span class="p">(</span><span class="nx">Component</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kr">class</span> <span class="nx">WebsiteContextComponent</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
</span><span class='line'>    <span class="kr">static</span> <span class="nx">propTypes</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">dispatch</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">state</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">object</span><span class="p">.</span><span class="nx">isRequire</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">params</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">shape</span><span class="p">({</span>
</span><span class='line'>        <span class="nx">websiteId</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">.</span><span class="nx">isRequired</span>
</span><span class='line'>      <span class="p">})</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_setCurrentWebsite</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">componentDidUpdate</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">_setCurrentWebsite</span><span class="p">();</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">_setCurrentWebsite</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="kr">const</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">dispatch</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">params</span><span class="o">:</span> <span class="p">{</span> <span class="nx">websiteId</span> <span class="p">},</span>
</span><span class='line'>        <span class="nx">state</span><span class="o">:</span> <span class="p">{</span> <span class="nx">websites</span> <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// prepare context data here..</span>
</span><span class='line'>      <span class="kr">const</span> <span class="nx">website</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">websites</span><span class="p">,</span> <span class="p">{</span> <span class="nx">id</span><span class="o">:</span> <span class="nx">websiteId</span> <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">dispatch</span><span class="p">(</span><span class="nx">loadContextWebsite</span><span class="p">(</span><span class="nx">website</span><span class="p">));</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="kr">const</span> <span class="p">{</span> <span class="nx">state</span><span class="o">:</span> <span class="p">{</span> <span class="nx">website</span> <span class="p">}</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">return</span> <span class="p">(</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&quot;website-context&quot;</span><span class="o">&gt;</span>
</span><span class='line'>          <span class="p">{</span> <span class="nx">website</span> <span class="o">?</span> <span class="o">&lt;</span><span class="nx">Component</span> <span class="p">{...</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">}</span> <span class="o">/&gt;</span> <span class="o">:</span> <span class="kc">null</span> <span class="p">}</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span class='line'>      <span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kr">const</span> <span class="nx">mapStateToProps</span> <span class="o">=</span> <span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">state</span><span class="o">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">application</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nx">connect</span><span class="p">(</span><span class="nx">mapStateToProps</span><span class="p">)(</span><span class="nx">WebsiteContextComponent</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Routing,</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">const</span> <span class="nx">routes</span> <span class="o">=</span> <span class="p">(</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/signup&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">SignUp</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/signin&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">SignIn</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// applied here..</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/welcome-on-board&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">checkBoarded</span><span class="p">(</span><span class="nx">Welcome</span><span class="p">,</span> <span class="p">{</span> <span class="nx">withValue</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">redirectTo</span><span class="o">:</span> <span class="s1">&#39;/app/dashboard&#39;</span><span class="p">})</span> <span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/forgot-password&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">ForgotPassword</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/signout&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">SignOut</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// .. and here</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/app&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">checkBoarded</span><span class="p">(</span><span class="nx">requiresAuth</span><span class="p">(</span><span class="nx">App</span><span class="p">),</span> <span class="p">{</span> <span class="nx">withValue</span><span class="o">:</span> <span class="kc">false</span><span class="o">:</span> <span class="nx">redirectTo</span><span class="o">:</span> <span class="s1">&#39;/welcome-on-board&#39;</span> <span class="p">})}</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;dashboard&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;dashboard&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Dashboard</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;profile&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;user-profile&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">UserProfile</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;websites&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;websites/:id&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">websiteContext</span><span class="p">(</span><span class="nx">Websites</span><span class="p">)}</span><span class="o">&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;banners&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;banners&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Dashboard</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>        <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;revenues&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;revenues&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Revenues</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/config&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">requiresAuth</span><span class="p">(</span><span class="nx">Config</span><span class="p">)}</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;page&quot;</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;page&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">PageConfig</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;*&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">FourOFour</span><span class="p">}</span> <span class="nx">status</span><span class="o">=</span><span class="p">{</span><span class="mi">404</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span><span class='line'><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Compose all the things</h2>

<p>We sometimes need to apply a few higher-order components on the same route. As from routing above, we can see that <code>/app</code> route both <code>requiresAuth()</code> and <code>checkBoarded()</code>. Sooner or later, you might have 3-4 function calls there; that makes <code>Routes</code> a bit bulky.</p>

<p>Fortunately, higher-order components are easily composable,</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">const</span> <span class="nx">CheckedWelcome</span> <span class="o">=</span> <span class="nx">composeComponents</span><span class="p">(</span>
</span><span class='line'>  <span class="nx">Welcome</span><span class="p">,</span>
</span><span class='line'>  <span class="p">[</span>
</span><span class='line'>    <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">checkBoarded</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="p">{</span> <span class="nx">withValue</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">redirectTo</span><span class="o">:</span> <span class="s1">&#39;/app/dashboard&#39;</span> <span class="p">}),</span>
</span><span class='line'>    <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">requiresAuth</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span>
</span><span class='line'>  <span class="p">]</span>
</span><span class='line'><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="kr">const</span> <span class="nx">CheckApp</span> <span class="o">=</span> <span class="nx">composeComponents</span><span class="p">(</span>
</span><span class='line'>  <span class="nx">App</span><span class="p">,</span>
</span><span class='line'>  <span class="p">[</span>
</span><span class='line'>    <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">checkBoarded</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="p">{</span> <span class="nx">withValue</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">redirectTo</span><span class="o">:</span> <span class="s1">&#39;/welcome-on-board&#39;</span><span class="p">}),</span>
</span><span class='line'>    <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">requiresAuth</span><span class="p">(</span><span class="nx">c</span><span class="p">),</span>
</span><span class='line'>    <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">requiresSmth</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="p">{</span> <span class="nx">options</span><span class="o">:</span> <span class="p">{}</span> <span class="p">})</span>
</span><span class='line'>  <span class="p">]</span>
</span><span class='line'><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="kr">const</span> <span class="nx">routes</span> <span class="o">=</span> <span class="p">(</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="c1">// much more clean route definition</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/welcome-on-board&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">CheckedWelcome</span><span class="p">}</span> <span class="o">/&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/app&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">CheckedApp</span><span class="p">}</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="c1">// ...</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/Route&gt;</span>
</span><span class='line'><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>composeComponents()</code> is a simple reducer utility function,</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kr">export</span> <span class="kd">function</span> <span class="nx">composeComponents</span><span class="p">(</span><span class="nx">component</span><span class="p">,</span> <span class="nx">wrappers</span> <span class="o">=</span> <span class="p">[])</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">wrappers</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">c</span><span class="p">,</span> <span class="nx">wrapper</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">wrapper</span><span class="p">(</span><span class="nx">c</span><span class="p">),</span> <span class="nx">component</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>So, higher-order components is a great concept that aims to <a href="https://medium.com/@dan_abramov/mixins-are-dead-long-live-higher-order-components-94a0d2f9e750#.ujvvraysa">replace Mixins</a> as composition mechanism. My experience showed they are great as containers wrappers, but in general, they have many practical applications.</p>

<p><em>Originally published at <a href="http://engineering.blogfoster.com/higher-order-components-theory-and-practice/">blogfoster Engineering</a>.</em></p>

      <div class="post sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://beletsky.net/2016/05/higher-order-components-theory-and-practice.html" data-via="alexbeletsky" data-counturl="http://beletsky.net/2016/05/higher-order-components-theory-and-practice.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-layout="button_count" data-show-faces="false" data-height="20"></div>
  
</div>

      <p class="post byline author vcard">
	Posted by <a href="/about">Alexander Beletsky</a>. If you liked that material, please consider to follow my <a href="http://twitter.com/alexbeletsky">twitter</a> account for further updates. If you have comments or questions, do not hesitate to contact my <a href="mailto:alexander.beletsky@gmail.com">email</a> or raise issue on <a href="https://github.com/alexbeletsky/alexanderbeletsky.github.io/issues">github</a>.
</p>
    </div>
  </div>

</article>
</div>
	<footer class="pure-g-r"><div class="inner pure-u-1">
	<p>
		Theme by <a href="https://twitter.com/alexbeletsky">@alexbeletsky</a> | Fonts by <a href="http://www.google.com/fonts/">Google Fonts</a> | Icons by <a href="http://fontello.com/">Fontello</a> | Hosted on <a href="http://github.com">github</a> | Powered by <a href="http://octopress.org/">Octopress</a>
	</p>
	<p>
		Copyright © 2010 - 2018 beletsky.net
	</p>
</div>

</footer>
	<div class="buttons">
	


	
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>


	
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>


	
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


	

</div>
</body>
</html>
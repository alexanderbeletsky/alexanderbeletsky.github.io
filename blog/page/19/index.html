
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Alexander Beletsky's development blog</title>
  <meta name="author" content="Alexander Beletsky">

  
  <meta name="description" content="MSDTC on server is not available exception Jul 11th, 2010 Tips During implementation of Linq to SQL of Entities application you can see such &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://alexanderbeletsky.github.io/blog/page/19/index.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/fontello.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/pure-min.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/style.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Alexander Beletsky's development blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:800' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Lato:300,400,700' rel='stylesheet' type='text/css'>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-16388698-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>


<body>
	<header class="pure-g-r"><div class="pure-g-r">
	<div class="inner pure-u-1">
		<h4 class="light">Alexander Beletsky's development blog</h4>
		<h1><a href="/">My profession is engineering</a></h1>
		<nav role="navigation" class="pure-menu pure-menu-open pure-menu-horizontal light"><ul>
	<li><a href="/projects">Projects</a></li>
	<li><a href="/talks">Talks</a></li>
	<li><a href="/blog/archives">Archive</a></li>
	<li><a href="/about">About me</a></li>
</ul>

</nav>
	</div>
</div>

</header>
	<div class="social inner pure-menu-horizontal"><ul>
	<li><a class="twitter icon-twitter" href="http://twitter.com/alexbeletsky"></a></li>
	<li><a class="github icon-github-circled" href="https://github.com/alexanderbeletsky"></a></li>
	<li><a class="stackoverflow icon-stackoverflow" href="http://stackoverflow.com/users/386751/alexanderb"></a></li>
	<li><a class="rss icon-rss" href="http://feeds.feedburner.com/abeletskyblog"></a></li>
</ul>
</div>
	<div id="content" class="inner pure-g-r"><div class="blog-index">
  
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2010/07/msdtc-on-server-is-not-available.html">
    
      MSDTC on server is not available exception</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2010-07-11T20:00:00+03:00" pubdate data-updated="true">Jul 11<span>th</span>, 2010</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/tips/'>Tips</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>
During implementation of Linq to SQL of Entities application you can see such exception:
</p>
<p>
<i>System.Data.SqlClient.SqlException : MSDTC on server &#8216;SRV\5118CF33-D353-46&#8217; is unavailable.</i>
</p>
<p>
Generally it means that there are several transactions is being created in application and they have to be managed by a special service, called &#8220;Distributed Transactions Coordinator&#8221; that is by default is not started. So, the quickest solution is just to start the service manually. Go to Start -> Control Panel -> Administrative Tools -> Services and start &#8220;Distributed Transactions Coordinator&#8221;. If it is required by your configuration you can set it as &#8220;Automatic&#8221; startup type, to run at as your server up.
</p>
<a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://1.bp.blogspot.com/_stL4bIIuRUs/TDn5EzrqpfI/AAAAAAAAG2c/Lv_H5U6cOyQ/s1600/services.png"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 225px;" src="http://1.bp.blogspot.com/_stL4bIIuRUs/TDn5EzrqpfI/AAAAAAAAG2c/Lv_H5U6cOyQ/s400/services.png" border="0" alt=""id="BLOGGER_PHOTO_ID_5492695081543181810" /></a>
<p>
But please be sure <b>what you are doing</b>, because this exception could also show some issues in application. As soon as it is appeared after some code changes, you have to clearly understand that involvement of Distributed Coordinator is expected behaviour. 
</p>
<p>
What happened to me with my Linq to SQL application is following: there are two 
    classes that create instance of DataModel class, first one is DbSetup that responsible for some preparation of data for tests, second is Repository object. DbSetup was also opening a TransactionScope object, to rollback all data that is being created during tests. This what created a problem - as soon as TransactionScope opened in scope of DataModel within DbSetup class, DataModel created in Repository was treated by runtime as a part of another transaction. That&#8217;s why runtime starting to request &#8220;Distributed Transactions Coordinator&#8221; to manage transactions. So, in unit test code I changed the constructor of Repository to accept DataModel created in DbSetup as constructor argument, so only one &#8220;transacted&#8221; DataModel object used in application. That solved my problem, without starting up coordinator.   
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2010/07/interesting-from-my-reader-this-week_09.html">
    
      Interesting from my Reader this week</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2010-07-09T17:58:00+03:00" pubdate data-updated="true">Jul 9<span>th</span>, 2010</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/reading/'>Reading</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>
My weekly update is what is going on in my Reader:
</p>
<ul>
<li>
<a href="http://weblogs.asp.net/scottgu/archive/2010/07/06/introducing-webmatrix.aspx">Introducing WebMatrix</a>. Next and very loud announcement by ScottGu. WebMatrix is something that .NET platform lacks for years. Now it brings the gaps between complexity of ASP.net application and current needs for rapid web development. It could be analog of <a href="http://instantrails.rubyforge.org/wiki/wiki.pl">Instant Rails</a> for Ruby on Rails developers. So, Web Matrix is a tiny package including simple IDE, IIS Express, SQL compact edition and number of templates. It believe it will be used by bloggers and small size web site holders.
</li>
<li>
<a href="http://www.joelonsoftware.com/items/2010/07/07.html">Web Applications Stack Exchange now in beta</a>. Joel Spolsky did announce of Wep Applications product. Next product after a very popular <a href="http://stackoverflow.com/">StackOverflow</a>. Like a StackOverflow it is done like QnA site, but maybe for more broader audience.
</li>
<li>
<a href="http://5whys.com/blog/scrum-vs-kanban-attitudes.html?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed:+5whys+(5+Whys)">Scrum vs. Kanban attitudes</a>. Roy Osherove gives a link about comparing Scrum vs. Kanban. I&#8217;m quite new with Kanban and I didn&#8217;t want to spend to much time to understand what it&#8217;s all about, so I found this comparison interesting.
</li>
<li>
<a href="http://blog.objectmentor.com/articles/2010/07/05/software-calculus-the-missing-abstraction">Software Calculus - The Missing Abstraction</a>. A little bit geek philosophy from Object Mentor. 
</li>
<li>
<a href="http://www.codeproject.com/KB/aspnet/ASP_NET_MVC_WITH_EF.aspx">Architecture Guide: ASP.NET MVC Framework + N-tier + Entity Framework and Many More</a>. Good and comprehensive tutorial on ASP.NET MVC with Entity framework.
</li>
<li>
<a href="http://odetocode.com/Blogs/scott/archive/2010/07/04/what-a-difference-8-years-makes-in-code.aspx">What a Difference 8 Years Makes (In Code)</a>. Just a nice to look of how code is changing with time and technologies, by K. Scott Allen.
</li>
</ul>
<!-- AddThis Button BEGIN -->
<div><a expr:addthis:title='data:post.title' expr:addthis:url='data:post.url' class='addthis_button'><img src="http://s7.addthis.com/static/btn/v2/lg-share-en.gif" width="125" height="16" alt="Bookmark and Share" style="border:0"/></a>
<script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#username=xa-4c30246f249329c8"></script></div>
<!-- AddThis Button END --></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2010/07/using-of-mutation-testing-in-real.html">
    
      Using of Mutation Testing in real project</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2010-07-09T16:00:00+03:00" pubdate data-updated="true">Jul 9<span>th</span>, 2010</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/tdd/'>TDD</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>
Recently I&#8217;ve been shared with a very interesting article by <a href="http://www.simple-talk.com/author/jeremy-jarrell-/">Jeremy Jarrel</a> about a <a href="http://www.simple-talk.com/dotnet/.net-tools/mutation-testing/">mutating testing</a>. I was really exited about that cause I really like different techniques and approaches that could help to gather better level of code quality (and tests quality). I would like to share my experience of first try it on project I&#8217;m working on now.   
</p>
<h2>What Mutating testing is all about?</h2>
<p>
The idea is fairly simple. As soon as you have a code that is being tested by a series of unit tests and all of these unit tests are currently in green state, you are able to validate how good your unit tests are, by changing a tested code a bit a see the results. This &#8220;changing&#8221; procedure is actually called - mutation. In ideal case all green tests have to be turned red, if some of tests are still green that means that testing code is not good enough to react on mutation, so actual test code must be reviewed and corrected. This is something that is called - mutation testing analysis.
</p>
<h2>The project to try on</h2>
<p>
I&#8217;m currently working on project that has been developed for some time, but with no tests. So a lot of legacy code has to be supported. We started to do tests where and thought about 4 months created nearly 300 tests. It is good time to try mutation on those cases. I&#8217;ve assured once more that all tests are good and no failures at this moment. Let&#8217;s go!
</p>
<h2>MutantPower application</h2>
<p>
In the article that I referenced above Jeremy not only gave a theoretical aspects but also provided with a simple mutation tool, called MutantPower. This is also what I&#8217;m going to use throught. So, I&#8217;ve downloaded sources and reviewed them. Code is a really simple, uses Mono <a href="http://www.mono-project.com/Cecil">Cecil</a> framework to load assembly, get all instructions and change instruction <a href="http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.brtrue_s.aspx">Brtrue_S</a> to <a href="http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.brfalse_s.aspx">Brfalse_S</a>, and otherwise. So, I&#8217;ve built application and was ready to start experimenting.
</p>
<h2>First failure</h2>
<p>
I have a one big assembly with a tested code, so what I need to do is to mutate this assembly and re-run all tests to see results. But on a first run of MutantPower I got a <i>NullReferenceException</i>. I&#8217;ve checked out in debugger and the problem was that MutualPower use the Body of MethodDefinition object, but not always methodDefinition contains a Body, so check for null is missing. After some corrections it started to work and I could successfully instrument the assembly.
</p>
<h2>Re-signing of tested assembly</h2>
<p>
I&#8217;ve successfully mutate my assembly and tried to re-run unit tests. It failed at the very beginning, since it was a strong named, run time detects failure of digital signature and refuses to load library. It has to be resigned each time after mutating. It could be easily done by <a href="http://msdn.microsoft.com/en-us/library/k5b5tt23(VS.80).aspx">sn.exe</a> tool. 
</p>
<p>
<blockquote><code><font size="2" face="Courier New" color="black">sn.exe -R tested_assembly.dll C:\Work\rd\Testing\TestApplication\bin\Debug\Company.snk</font><br><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote>
</p>
<h2>First unit tests results</h2>
<p>
After resigning assembly successfully loaded and unit tests started. Some tests were passing and a lot of tests were failing (that is have to be during mutation testing). I was quite happy to see first results. But with mutation you have to be really careful and understand real reason of failures. I found out that most of tests failed with <i>NullReferenceException</i> somewhere from deep parts tested assembly. After a bit of investigation I found out that one of the vital application classes could be instantiated. Sure, MutualPower does not distinguish between &#8220;code need to be tested&#8221; and &#8220;infrastructure code&#8221; that makes application able to run at all. So these first results had no sense at all, since the testing not even started.</p>
<h2>Configuration for MutualPower</h2>
<p>
I came up with one simple idea. Extend MutualPower with a configuration file that would say what exact types must be included for mutating to leave infrastructure code as is but affect the rest of code (BLL, DAL, pages etc.). So, I&#8217;ve changed the application to take such configuration into account. After inspection of all test cases created so far I came up with such configuration file: 
</p>
<p>
<blockquote><code><font size="2" face="Courier New" color="black"><font color="#0000ff">&#60;?</font><font color="#800000">xml</font> <font color="#ff0000">version</font><font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font><font color="#0000ff">="utf-8"</font> ?<font color="#0000ff">&#62;</font><br><font color="#0000ff">&#60;</font><font color="#800000">types</font><font color="#0000ff">&#62;</font><br>&nbsp;<font class="rem">&#60;!-- ASP.net pages types --&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="ard_ardrequest"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="ard_periods"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="ard_closingsheet"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="ard_copyfinancecodes"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font class="rem">&#60;!-- DAL types --&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.src.AnnualReport.DAL.ArdCompanyData"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.src.AnnualReport.DAL.ArdDepartmentData"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.src.AnnualReport.DAL.ArdPeriodData"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.src.AnnualReport.DAL.ArdPeriodData.ArdRequestData"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.src.AnnualReport.DAL.ArdPeriodData.ClosingSheetData"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.src.AnnualReport.DAL.ArdPeriodData.CopyFinanceCodesData"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.src.AnnualReport.DAL.ArdPeriodData.PeriodsData"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font class="rem">&#60;!-- BLL types --&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.Ard"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.ArdCacheClosingSheetData"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.ArdUpdateBalance"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font class="rem">&#60;!-- Forms and control types --&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.ArdReportTemplate"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.EditTypes.ReportDesignerTemplateTypes"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.EditTypes.TemplateGroupField"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.FormArdCompanyReport"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.FormArdTemplateCopy"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.FormArdTemplate"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.FormCompanies"</font><font color="#0000ff">/&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">type</font> <font color="#ff0000">included</font><font color="#0000ff">="Company.FormCompanyGroup"</font><font color="#0000ff">/&#62;</font><br><font color="#0000ff">&#60;/</font><font color="#800000">types</font><font color="#0000ff">&#62;</font></font><br><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote>
</p>
<p>
Now MutualPower will change only types mentioned in configuration file as &#8220;included&#8221;. 
</p>
<h2>Next run and Timeout exception</h2>
<p>
After re-mutating and re-signing assembly again I got first more or less meaningful results. Yes, a lot of failures and even more.. my tested hanged out in a middle! This is something that is never have to be happen as soon as you do <a href="http://artofunittesting.com/">good unit tests</a>. 
</p>
<p><blockquote><code><font size="2" face="Courier New" color="black">System.InvalidOperationException : Timeout expired.&nbsp;The timeout period elapsed prior to obtaining a connection from the pool.&nbsp;This may have occurred because all pooled connections were in use and max pool size was reached.</font><br><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote></p>
<p>
Skipping the details, I found that there is a huge bug in my testing framework that doesn&#8217;t dispose connection to database in case of exception in constructor, so then you have a lot of failures the connection pool is quickly overused and you got TimeOut. Bingo. That might be first valuable result from mutating. Of cause, it is not a but in some production code, but keeping testing code in good shape is also very important. So I fixed the problem and ready to go for next iteration.  
</p>
<h2>Analysis of passed</h2>
<p>
Finally, I&#8217;ve got some results for analysis. Only 27 tests are passing, so all of them should be reviewed for actual reason.</p>
<p>
<p>
I&#39;ll do high-level breakdown of &quot;why tests passed&quot;..</p>
<p>
<ul>
<li>
<b>Tests from a 3rd parties</b> - we are using <a href="http://haacked.com/archive/2007/06/19/unit-tests-web-code-without-a-web-server-using-httpsimulator.aspx">HttpSimulator</a> and with a sources, test cases was also included to project. Since we are not modifying and it just works as expected, no need to keep it in test assembly. Should be removed.
</li>
<li>
<b>Tests on code that has not been mutated</b> - tests are passing because you forget to include tested class into MutantPowerConfiguration. Should correct configuration and run again.
</li>
<li>
<b>Empty test cases</b> - test that have no asserts in it. These are not the tests, so it might be either refactored to do asserts either removed at all.
</li>
<li>
<b>Smoke test</b> - the type of test I just to prefer start development with, it just creates a tested object and expects that no failures happened.
</li>
</ul>
</p>
<p>
That&#8217;s it! Nothing that could show a dumb mistakes either in code or tests that I really wanted to archive. So, I&#8217;ve cleaned up tests a bit and came up with only 8 passing ones.
</p>
<h2>Analysis of failed</h2>
<p>
So, why tests are failing? 99.9% of all failures came from DAL level with a <i>ArgumentOutOfRangeException</i> exception. Meaning that MutantPower changed the assembly so badly that no data could be even retrieved. If no data retrieved -> logic does not start to work -> tests are failed. That turns out to something not mutation, but breaking. MutualPower in its initial version is to simple and for sure required more fine tuning except configuration file. Another aspect related to our architectural/design problem. Currently code of business logic is high cohesion of data access layer, namely all testing is goes on SQL database with no mocks. So, since the lowest layer is corrupted all upper layers just could not stay alive. OK, this conclusion might be a second valuable result gave by mutation. 
</p>
<p>
In ideal case all tests my be clearly separated on BLL tests, DAL tests. It has no much sense to mutate DAL code, as for me. BLL tests must use mocks, so be completely independent on database, database testing should be part of integration testing. By doing this it might happen that mutation give a valuable feedback.
</p>
<p>
So, just initial analysis of failures showed architectural drawbacks of application that must be some how corrected to get more benefits of mutating testing.
</p>
<h2>Conclusion</h2>
<ol>
<li>
Mutation testing is definitely something interesting but requires an effort to get benefits from it.
</li>
<li>
It would give more meaningful results if application is created with a good separation of layers and usage a mocks in unit tests.
</li>
<li>
It helped out to see behavior of tests in more stressed conditions and find a recourse leakage in tests. 
</li>
<li>
Some areas for improvements exists to update MutantPower with fine tuning.
</li>
<li>
It is not seems to be daily based practice, but more likely once for iteration of two. Also thinking about criteria related to tests number like, as soon as next 100 tests added, run mutation testing to check quality.
</li>
</ol>
<p>
Finally I&#8217;ve put sources and binaries on github.
</p>
<p>
Source code - <a href="http://github.com/alexanderbeletsky/MutantPower">http://github.com/alexanderbeletsky/MutantPower</a>
<br />
MutantPower application - <a href="http://github.com/alexanderbeletsky/MutantPower/downloads">http://github.com/alexanderbeletsky/MutantPower/downloads</a>
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2010/07/spell-checker-for-vs2010.html">
    
      Spell checker for VS2010</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2010-07-07T15:56:00+03:00" pubdate data-updated="true">Jul 7<span>th</span>, 2010</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/tools/'>Tools</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>
 I&#8217;ve noticed that I do a lot of spell mistakes in my posts, so I started to 
    think about some online tools that would do spell checking before submit post to blog. There are several good enough, but the problem is that they work with a plain text, but I do posts in HTML first.. so checker was giving a lot of mistakes on HTML tags, that is pretty annoying.
</p>
<p>
As I do my posts in VS initially I started to look for some pluggins that would do spell checking just within Visual Studio, so you don&#8217;t need any other tools. I came up with very nice one, so I want to share it with you:
</p>
<p>
<a href="http://visualstudiogallery.msdn.microsoft.com/en-us/7c8341f1-ebac-40c8-92c2-476db8d523ce">Checker for VS 2010 by Noah Richards</a>
</p>
<p>
Easy to install and use.. Spell checking for HTML/ASP.net code, as well as source code (commentaries). So, I hope are not going to see spell any bugs in my posts any more. 
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2010/07/james-shore-design-challange-review-by.html">
    
      James Shore design challange review by Par Oaz</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2010-07-06T11:10:00+03:00" pubdate data-updated="true">Jul 6<span>th</span>, 2010</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/design/'>Design</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>Some time ago I was taking part into <a href="http://abeletsky.blogspot.com/2010/06/architectural-design-challenge-by-james.html">design challange</a> by James Shore. One of participants <a href="http://agilitateur.azeau.com/">Par Oaz</a> did his own analisys of all submitted solutions. He did a very nice job putting his effort on this, it was really interesting to check it out.</p>
<p>
You can find an article by this link: <a href="http://agilitateur.azeau.com/post/2010/07/06/Architectural-Design-Challenge-by-James-Shore-:-a-review">http://agilitateur.azeau.com/post/2010/07/06/Architectural-Design-Challenge-by-James-Shore-:-a-review</a>
</p>
<p>Thanks for review, Par!</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2010/07/interesting-from-my-reader-this-week.html">
    
      Interesting from my Reader this week</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2010-07-02T11:37:00+03:00" pubdate data-updated="true">Jul 2<span>nd</span>, 2010</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/reading/'>Reading</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>
This week I liked such things came up from my reader.
</p>
<ul>
<li>
<a href="http://odetocode.com/Blogs/scott/archive/2010/06/28/enforcing-a-base-controller.aspx">Enforcing a Base Controller</a>. K. Scott Allen using very interesting technique for assert that some particular class is derived from expected class using reflection. That could be reused not only for case of Controllers (as Scott use) but any other classes.
</li>
<li>
<a href="http://weblogs.asp.net/scottgu/archive/2010/06/30/new-embedded-database-support-with-asp-net.aspx">New Embedded Database Support with ASP.NET</a>. Announcement by Scott Gu of new DBMS by Microsoft that is positionized as brand-new, lightweight, no-install-require database system. It really looks interesting, so please welcome - SQL Server Compact Edition 4.
</li>
<li>
<a href="http://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx">Introducing IIS Express</a>. One more big annoucement by Scott Gu. IIS Express is new web server aimed to make life of ASP.net developers easy and fun. It should combine easy-of-use features of ASP.net development server and power of IIS server. Sure it is integrated with VS 2010.
</li>
<li>
<a href="http://tutorialzine.com/2010/06/microtut-how-css-position-works/">MicroTut: How CSS Positioning Works</a>. As usually a vey good tutorial by Martin Angelov. Explains something that you always forget and very nice to fresh up memory from time to time.  
</li>
<li>
<a href="http://www.hanselman.com/blog/TheWeeklySourceCode52YouKeepUsingThatLINQIDunnaThinkItMeansWhatYouThinkItMeans.aspx?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed:+ScottHanselman+(Scott+Hanselman+-+ComputerZen.com)">The Weekly Source Code 52 - You keep using that LINQ, I dunna think it means what you think it means</a>. Very nice article by Scott Henselman about a pitfalls you will never 
    know during coding with Linq (or any other ORM with generation of SQL). I 
    remember a talk with my collegue from Denmark, Christian, then I was asking 
    about his thoughts about &quot;Is is good to start to use Linq for our project?&#8221; he said, &#8220;It is good till you keep eye on a actuall SQL that is being generated by framework&#8221;. Now I undrestand what he meant.
</li>
</ul>
<p>
Happy reading!
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2010/06/ddd-implementation-of-repository.html">
    
      DDD, Implementation of Repository pattern with Linq to SQL</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2010-06-30T19:06:00+03:00" pubdate data-updated="true">Jun 30<span>th</span>, 2010</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/ddd/'>DDD</a>, <a class='category' href='/blog/categories/linq/'>Linq</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
Lets review first and one of major DDD pattern - Repository. Repository is something that provides access to an entities objects (domain objects). Here what DDD patterns guide says on Repositories:
<br />
<br />
<i>
For each type of object that needs global access, create an object that can provide the illusion of an in-memory collection of all objects of that type. Set up access through a well-known global interface. Provide methods to add and remove objects, which will encapsulate the actual insertion or removal of data in the data store. Provide methods that select objects based on some criteria and return fully instantiated objects or collections of objects whose attribute values meet the criteria, thereby encapsulating the actual storage and query technology. Provide repositories only for aggregate roots that actually need direct access. Keep the client focused on the model, delegating all object storage and access to the repositories.
</i>
<br />
<br />
<h2>Preparation</h2>
<br />
Suppose we are having a database with table Users in it. First of all we have to create a Data Model class. To do that you can add &#8220;New item&#8221; to you class library (or application) and select Linq to Classes.
<br />
<br />
<a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://3.bp.blogspot.com/_stL4bIIuRUs/TCtrtiIPoMI/AAAAAAAAG1o/gFWf5MBbwMo/s1600/LinqToClasses.png"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 247px;" src="http://3.bp.blogspot.com/_stL4bIIuRUs/TCtrtiIPoMI/AAAAAAAAG1o/gFWf5MBbwMo/s400/LinqToClasses.png" border="0" alt=""id="BLOGGER_PHOTO_ID_5488599000880750786" /></a>
<br />
<br />
This will add new .dbml file your project. There are 2 ways of addition new entities to model. Either by designer (easy to use) or manually by coding .dbml file (harder to user by more flexibility). We will just use first way as more quick one. Just open you db in Server explorer and drag-and-drop Users table to .dbml designer. You will see something like that,
<br />
<br />
<a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://2.bp.blogspot.com/_stL4bIIuRUs/TCtr2X9znlI/AAAAAAAAG1w/fTqMklm0_WM/s1600/UsersInDesigner.png"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 216px;" src="http://2.bp.blogspot.com/_stL4bIIuRUs/TCtr2X9znlI/AAAAAAAAG1w/fTqMklm0_WM/s400/UsersInDesigner.png" border="0" alt=""id="Img1" /></a>
<br />
<br />
Now if you open corresponding .cs file of Data Model you can easily see what code is actually generated by Linq to SQL. Let&#8217;s quickly review it. So, most improtant class is DataContext.
<br />
<br />
<blockquote><code><font size="2" face="Courier New" color="black">&nbsp;&nbsp;[global::System.Data.Linq.Mapping.DatabaseAttribute(Name=<font color="#A31515">"trackyourtasksdb"</font>)]<br>&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> TrackYourTasksDataContext : System.Data.Linq.DataContext<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">private</font> <font color="#0000ff">static</font> System.Data.Linq.Mapping.MappingSource mappingSource = <font color="#0000ff">new</font> AttributeMappingSource();<br></font><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote>
<br />
<br />
<a href="http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.aspx">DataContext</a> is something that suppose provide access to tables and objects and track the state of these objects. It uses SubmitChanges() method to flush the data to database. It is lightweight object and you should instantiate in in method of class scope, there are no reasons to keep a single copy of object for whole application. It is not only possible to work with tables within DataContext, but stored procedures as well.  
<br />
<br />
Besides of that the object represenation of table record is generated. The class is called User (please not that Linq to SQL is removing plural -s suffix by itself). 
<br />
<br />
<blockquote><code><font size="2" face="Courier New" color="black">&nbsp;&nbsp;[global::System.Data.Linq.Mapping.TableAttribute(Name=<font color="#A31515">"dbo.Users"</font>)]<br>&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> User : INotifyPropertyChanging, INotifyPropertyChanged<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">private</font> <font color="#0000ff">static</font> PropertyChangingEventArgs emptyChangingEventArgs = <font color="#0000ff">new</font> PropertyChangingEventArgs(<font color="#2B91AF">String</font>.Empty);<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">private</font> <font color="#0000ff">int</font> _Id;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">private</font> <font color="#0000ff">string</font> _Email;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">private</font> <font color="#0000ff">string</font> _SecretPhrase;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">private</font> <font color="#0000ff">string</font> _Password;<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">private</font> System.Data.Linq.Binary _Timestamp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//...</font><br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">public</font> User()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OnCreated();<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;[global::System.Data.Linq.Mapping.ColumnAttribute(Storage=<font color="#A31515">"_Id"</font>, AutoSync=AutoSync.OnInsert, DbType=<font color="#A31515">"Int NOT NULL IDENTITY"</font>, IsPrimaryKey=<font color="#0000ff">true</font>, IsDbGenerated=<font color="#0000ff">true</font>, UpdateCheck=UpdateCheck.Never)]<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">protected</font> <font color="#0000ff">int</font> Id<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">get</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">return</font> <font color="#0000ff">this</font>._Id;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">set</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font> ((<font color="#0000ff">this</font>._Id != <font color="#0000ff">value</font>))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">this</font>.OnIdChanging(<font color="#0000ff">value</font>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">this</font>.SendPropertyChanging();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">this</font>._Id = <font color="#0000ff">value</font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">this</font>.SendPropertyChanged(<font color="#A31515">"Id"</font>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">this</font>.OnIdChanged();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;[global::System.Data.Linq.Mapping.ColumnAttribute(Storage=<font color="#A31515">"_Email"</font>, DbType=<font color="#A31515">"NVarChar(MAX) NOT NULL"</font>, CanBeNull=<font color="#0000ff">false</font>, IsPrimaryKey=<font color="#0000ff">true</font>, UpdateCheck=UpdateCheck.Never)]<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">string</font> Email<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">get</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">return</font> <font color="#0000ff">this</font>._Email;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">set</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font> ((<font color="#0000ff">this</font>._Email != <font color="#0000ff">value</font>))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">this</font>.OnEmailChanging(<font color="#0000ff">value</font>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">this</font>.SendPropertyChanging();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">this</font>._Email = <font color="#0000ff">value</font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">this</font>.SendPropertyChanged(<font color="#A31515">"Email"</font>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">this</font>.OnEmailChanged();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//...</font><br><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote><br />
<br />
<br />
So as you see it incapsulates fields of table as corresponding properties of object. 
<br />
<br />
<h2>Interface</h2>
<br />
As it said above Repository have to add, remove as well as search and update objects. Note, that we work work with db record (entities classes) as we just work with in-memory objects. 
<br />
<br />
It is always good idea to work with such structures as Repositories, Factories, Services etc. throught interface. First of all, because it conforms to common object oriented design guidlines and make us possibility to have different implementation classes that would provide different behavior. Second, that with interfaces you can substitute real object with mock object during testing. Moreover with interfaces it is easy to use <a href="http://martinfowler.com/articles/injection.html">Dependency Injection</a> pattern, that improves application flexability and testability.
<br />
<br />
User repository interface looks like,
<br />
<br />
<blockquote><code><font size="2" face="Courier New" color="black"><font color="#0000ff">using</font> System;<br><font color="#0000ff">using</font> System.Linq;<br><font color="#0000ff">using</font> System.Text;<br><font color="#0000ff">using</font> Trackyourtasks.Core.DAL.DataModel;<br><br><font color="#0000ff">namespace</font> Trackyourtasks.Core.DAL<br>{<br>&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">interface</font> IUsersRepository<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;User FindUserById(<font color="#0000ff">int</font> id);<br>&nbsp;&nbsp;&nbsp;&nbsp;User FindUserByEmail(<font color="#0000ff">string</font> email);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">void</font> SaveUser(User user);<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">void</font> DeleteUser(User user);<br>&nbsp;&nbsp;}<br>}<br></font><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote>
<br />
<br />
Now let&#8217;s implement this repository with Linq to SQL tools. We would review all methods, one by one.
<br />
<br />
<u>Construction of Repository:</u>
<br />
<br />
<blockquote><code><font size="2" face="Courier New" color="black"><font color="#0000ff">using</font> System;<br><font color="#0000ff">using</font> System.Collections.<font color="#2B91AF">Generic</font>;<br><font color="#0000ff">using</font> System.Linq;<br><font color="#0000ff">using</font> System.Text;<br><font color="#0000ff">using</font> Trackyourtasks.Core.DAL.DataModel;<br><br><font color="#0000ff">namespace</font> Trackyourtasks.Core.DAL<br>{<br>&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">class</font> UsersRepository : IUsersRepository<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;TrackYourTasksDataContext _context = <font color="#0000ff">new</font> TrackYourTasksDataContext();<br></font><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote>
<br />
<br />
As you see I instantiate DataContext object as a member of UsersRepository class. So, it will be alive and tracking objects since UserRepository class is alive. 
<br />
<br />
<u>Find methods:</u>
<br />
<br />
<blockquote><code><font size="2" face="Courier New" color="black">&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">public</font> User FindUserById(<font color="#0000ff">int</font> id)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">return</font> (<font color="#0000ff">from</font> user <font color="#0000ff">in</font> _context.Users <font color="#0000ff">where</font> user.Id == id <font color="#0000ff">select</font> user).SingleOrDefault();<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">public</font> User FindUserByEmail(<font color="#0000ff">string</font> email)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">return</font> (<font color="#0000ff">from</font> user <font color="#0000ff">in</font> _context.Users <font color="#0000ff">where</font> user.Email == email <font color="#0000ff">select</font> user).SingleOrDefault();<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote>
<br />
<br />
Impelementation is just a simple Linq query that selects object either by Id or Email. I use <a href="http://msdn.microsoft.com/en-us/library/system.linq.enumerable.singleordefault.aspx">SingleOrDefault()</a> that returns object if found and default if not (null in my case). 
<br />
<br />
<u>Save and Update methods:</u>
<br />
<br />
<blockquote><code><font size="2" face="Courier New" color="black">&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">void</font> SaveUser(User user)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font> (user.Id == 0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_context.Users.InsertOnSubmit(user);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_context.SubmitChanges();<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote>
<br />
<br />
So, if are created user entiry by new operator it will contain Id == 0 (meaning no Id, yet), as we passing it to Save method it will check is this object persistant or not and if not it will be add it to storage. Since context object is not disposed after, it still continue track object changes, so if we decieded to change some object fields and store it all we need to do is call <a href="http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.submitchanges.aspx">SubmitChanges()</a> method and corrsponding record will be updated. I&#8217;ll put some tests here to see how it works:
<br />
<br />
<blockquote><code><font size="2" face="Courier New" color="black">&nbsp;&nbsp;&nbsp;&nbsp;[Test]<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">void</font> InsertUser()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//INIT</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> register = <font color="#0000ff">new</font> UsersRepository();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//ACT</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> user = <font color="#0000ff">new</font> User()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Email = <font color="#A31515">"email"</font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecretPhrase = <font color="#A31515">"sec"</font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Password = <font color="#A31515">"pass"</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;register.SaveUser(user);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//POST</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> actual = register.FindUserByEmail(<font color="#A31515">"email"</font>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Assert.That(actual, Is.Not.Null);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;[Test]<br>&nbsp;&nbsp;&nbsp;&nbsp;[ExpectedException(<font color="#0000ff">typeof</font>(DuplicateKeyException))]<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">void</font> InsertUserTwice()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//INIT</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> register = <font color="#0000ff">new</font> UsersRepository();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//ACT / POST</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> user = <font color="#0000ff">new</font> User()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Email = <font color="#A31515">"email"</font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecretPhrase = <font color="#A31515">"sec"</font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Password = <font color="#A31515">"pass"</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;register.SaveUser(user);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> newUser = <font color="#0000ff">new</font> User()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Email = <font color="#A31515">"email"</font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecretPhrase = <font color="#A31515">"sec"</font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Password = <font color="#A31515">"pass"</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;register.SaveUser(newUser);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;[Test]<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">void</font> UpdateUser()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//INIT</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> register = <font color="#0000ff">new</font> UsersRepository();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> user = <font color="#0000ff">new</font> User()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Email = <font color="#A31515">"email"</font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecretPhrase = <font color="#A31515">"sec"</font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Password = <font color="#A31515">"pass"</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;register.SaveUser(user);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//ACT</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user.SecretPhrase = <font color="#A31515">"newsec"</font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;register.SaveUser(user);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//POST</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> foundUser = register.FindUserById(user.Id);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Assert.That(foundUser, Is.Not.Null);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Assert.That(foundUser.SecretPhrase, Is.EqualTo(<font color="#A31515">"newsec"</font>));<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote>
<br />
<br />
<u>Delete Methods:</u>
<br />
<br />
<blockquote><code><font size="2" face="Courier New" color="black">&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">void</font> DeleteUser(User user)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_context.Users.DeleteOnSubmit(user);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_context.SubmitChanges();<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br></font><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote>
<br />
<br />
So object is marked as to be deleted by calling <a href="http://msdn.microsoft.com/en-us/library/bb763473.aspx">DeleteOnSubmit()</a> and it will be actually deleted on SubmitChanges() call. 
<br />
<br />
<h2>Conclusions</h2>
<br />
<br />
<p>
It is really easy to start up with Repositories keeping its implementation as simple as possible. Of cause, typicaly data structure in databases are bit more complex than plain table. But it is still possible to work with this pattern, combining with Repositories, Aggregates, Entities and Values.
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2010/06/ddd-domain-driven-development.html">
    
      DDD, Domain Driven Design</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2010-06-28T14:00:00+03:00" pubdate data-updated="true">Jun 28<span>th</span>, 2010</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/ddd/'>DDD</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
There is one great book by Jimmy Nilsson <a href="http://domaindrivendesign.org/books#DDD_apply">Applying Domain-Driven Design and Patterns</a> (russian translation of that book is just awful, so now I&#8217;m looking for orignal copy). Jimmy is describing DDD with a very nice examples and concepts, also he gives a good attension to TDD 
    and refactoring. If you want to start with DDD (and you have to) you should 
    check DDD website <a href="http://domaindrivendesign.org/">http://domaindrivendesign.org/</a> and I really liked personal <a href="http://jimmynilsson.com/blog/">blog</a> of Jimmy Nilsson. 
<br />
<br />
I already did use DDD in my previous <a href="http://abeletsky.blogspot.com/search/label/DDD">posts</a> while I designed registration functionality for web application. I believe that many of you are using DDD in your development practice but it could be rather implicit practice.
<br />
<br />
DDD is not something strict like methodologies or technologies are and give no strict rules how to do things, but rather a way of thinking how to work with domain specific within software development. What I personally like in DDD that it goes with a set of patterns that also helps to form common vocabulary for developers. There is a document that gives short summarize on DDD patterns, you can get is <a href="http://domaindrivendesign.org/sites/default/files/discussion/PatternSummariesUnderCreativeCommons.doc">here</a>.  
<br />
<br />
Let&#8217;s review triangle of What/Why/Where for DDD.
<br />
<br />
<h2>What ?</h2>
<br />
Domain Driven Development is a way of thinking for development of software that do focus on:
<ul>
<li>
<u>Core domain</u> - Understanding of domain is vital for any software <i>product</i>. Proper representation of domain with tools and languages you have is vital for any software <i>project</i>.
</li>
<li>
<u>Patterns</u> - If I met some problem I&#8217;m really sure that I&#8217;m not first person who did, and probably this problem is alredy solved (probably well enought). Such &#8220;solved&#8221; problems forms so called patterns, something &#8220;know-how&#8221; that could be reused for another partcular needs. There are <i>no reasons</i> to reinvent wheeel.
</li>
<li>
<u>Collaboration</u> - Collaboration between developers and domain experts as more extensive as possible. Experts could be a customers (customer on site as XP says) or other representive who in charge of product (product owner as Scrum says).
</li>
</ul>  
<br />
<br />
<h2>Why ?</h2>
<br />
Software is something that suppose to solve problems we met in life. DDD focused on these problems and tries to desing software as closer to problems as possible. Personally I think that DDD is a native way of software development.
<br />
<br />
<h2>Where ?</h2>
<br />
Everywhere actually. DDD is not for some specific areas. So, Web, Desktop, Fun or Science.. everything is applicable.
<br />
<br />
<h2>Conclusions</h2>
<br />
<p>
As I said on a beginning DDD is something that every developer shound aware about it (I would highlight word &#8220;aware&#8221; meaning it is not expected to be an expert on it, that always good, but know that it is exists and know key priciples). You will easy found a start up materials in internet. Meanwhile if I meet some examples of DDD patterns implementation I&#8217;ll do blog about it.
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2010/06/web-development-aspnet-ajax.html">
    
      Web development: ASP.NET Ajax, ScriptManager to recover a password</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2010-06-27T00:58:00+03:00" pubdate data-updated="true">Jun 27<span>th</span>, 2010</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/ajax/'>AJAX</a>, <a class='category' href='/blog/categories/ddd/'>DDD</a>, <a class='category' href='/blog/categories/asp-dot-net/'>asp.net</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
Remember a site we started to create in previous articles. What we&#8217;ve got is simple web application, 
    with a registration functionality. During registration you submit email, password and secret phrase. We going to use this secret phrase today to recover forgotten passwords. Functionality is bit artifictial but my goal is to demonstrate usage of ASP.NET Ajax framework, namely ScripManager object as very usefully component for ajaxifying your applications.
<br />
<br />
<h2>Preparation</h2>
<br />
I&#8217;ve added another page called ForgetPassword.aspx, it looks like this:
<br />
<a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://2.bp.blogspot.com/_stL4bIIuRUs/TCZ5PtqTslI/AAAAAAAAG1I/r47hme6j7LA/s1600/forgetpass.png"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 252px;" src="http://2.bp.blogspot.com/_stL4bIIuRUs/TCZ5PtqTslI/AAAAAAAAG1I/r47hme6j7LA/s400/forgetpass.png" border="0" alt=""id="BLOGGER_PHOTO_ID_5487206506859573842" /></a>
<br />
<br />
<a href="http://msdn.microsoft.com/en-us/magazine/cc163354.aspx">Script Manager</a> is really powerfull component and one of major feature is how it simplifies working with web services. So, let&#8217;s add ScriptManager to application. The place to do that are typically MasterPage to make ScrpitManager be accessible from every content page. It have to be placed in &#8216;form&#8217; with runat=&#8221;server&#8221; attribute, otherwise runtime exception will appear on page loading.
<br />
<br />
<blockquote><code><font size="2" face="Courier New" color="black"><font color="#0000ff">&#60;</font><font color="#800000">div</font> <font color="#ff0000">class</font><font color="#0000ff">="content"</font><font color="#0000ff">&#62;</font><br>&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">div</font> <font color="#ff0000">id</font><font color="#0000ff">="left"</font><font color="#0000ff">&#62;</font><br>&nbsp;&nbsp;&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">form</font> <font color="#ff0000">id</font><font color="#0000ff">="form1"</font> <font color="#ff0000">runat</font><font color="#0000ff">="server"</font><font color="#0000ff">&#62;</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">asp:ScriptManager</font> <font color="#ff0000">ID</font><font color="#0000ff">="ScriptManager"</font> <font color="#ff0000">runat</font><font color="#0000ff">="server"</font><font color="#0000ff">&#62;</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">Scripts</font><font color="#0000ff">&#62;</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">asp:ScriptReference</font> <font color="#ff0000">Path</font><font color="#0000ff">="~/js/forgetpassword.js"</font> <font color="#ff0000">ScriptMode</font><font color="#0000ff">="Auto"</font> <font color="#0000ff">/&#62;</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">&#60;/</font><font color="#800000">Scripts</font><font color="#0000ff">&#62;</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">Services</font><font color="#0000ff">&#62;</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">asp:ServiceReference</font> <font color="#ff0000">Path</font><font color="#0000ff">="~/services/ForgetPassword.asmx"</font> <font color="#0000ff">/&#62;</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">&#60;/</font><font color="#800000">Services</font><font color="#0000ff">&#62;</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">&#60;/</font><font color="#800000">asp:ScriptManager</font><font color="#0000ff">&#62;</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">asp:ContentPlaceHolder</font> <font color="#ff0000">ID</font><font color="#0000ff">="ContentPlaceHolder1"</font> <font color="#ff0000">runat</font><font color="#0000ff">="server"</font><font color="#0000ff">&#62;</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">&#60;/</font><font color="#800000">asp:ContentPlaceHolder</font><font color="#0000ff">&#62;</font><br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">&#60;/</font><font color="#800000">form</font><font color="#0000ff">&#62;</font>&nbsp;<br>&nbsp;<font color="#0000ff">&#60;/</font><font color="#800000">div</font><font color="#0000ff">&#62;</font>&nbsp;&nbsp;<br></font><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote>
<br />
<br />
Script Manager contains two references - ScriptReference, ServerReference. It is a declarative way to add references, in the same time it is possible to do it programmatically (that is more complicated). What you need to do is to add such declarations, the rest will be done by control. Next, we will add forgetpassword.js script to script folder and new web service instance to services folder. Now, application ready for AJAX!
<br />
<br />
<h2>Ajaxify It</h2>
<br />
Before we do something more serious let&#8217;s check that setup we created are actually working. Go to webservice code (ForgetPassword.asmx.cs):
<br />
<br />
<blockquote><code><font size="2" face="Courier New" color="black"><font color="#0000ff">namespace</font> WebApplication.Services<br>{<br>&nbsp;&nbsp;<font color="#008000">/// &#60;summary&#62;</font><br>&nbsp;&nbsp;<font color="#008000">/// Summary description for ForgetPassword</font><br>&nbsp;&nbsp;<font color="#008000">/// &#60;/summary&#62;</font><br>&nbsp;&nbsp;[WebService(Namespace = <font color="#A31515">"http://tempuri.org/"</font>)]<br>&nbsp;&nbsp;[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]<br>&nbsp;&nbsp;[System.ComponentModel.ToolboxItem(<font color="#0000ff">false</font>)]<br>&nbsp;&nbsp;<font color="#008000">// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. </font><br>&nbsp;&nbsp;[System.Web.Script.Services.ScriptService]<br>&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">class</font> ForgetPassword : System.Web.Services.WebService<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;[WebMethod]<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">string</font> HelloWorld()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">return</font> <font color="#A31515">"Hello World"</font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;}<br>}<br></font><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote>
<br />
<br />
Please note, there is attribute of service class [System.Web.Script.Services.ScriptService] that must be uncommented as soon as webservice is being used from java script code. Do not forget to uncomment it. And simple method is present there, HelloWorld that just returns a string. On a ForgetPassword.aspx page we have such form:
<br />
<br />
<blockquote><code><font size="2" face="Courier New" color="black"><font color="#0000ff">&#60;</font><font color="#800000">asp:Content</font> <font color="#ff0000">ID</font><font color="#0000ff">="Content2"</font> <font color="#ff0000">ContentPlaceHolderID</font><font color="#0000ff">="ContentPlaceHolder1"</font> <font color="#ff0000">runat</font><font color="#0000ff">="server"</font><font color="#0000ff">&#62;</font><br>&nbsp;&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">h2</font><font color="#0000ff">&#62;</font>Please fill form below<font color="#0000ff">&#60;/</font><font color="#800000">h2</font><font color="#0000ff">&#62;</font><br>&nbsp;&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">div</font> <font color="#ff0000">class</font><font color="#0000ff">="box"</font><font color="#0000ff">&#62;</font><br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">label</font><font color="#0000ff">&#62;</font>Email: <font color="#0000ff">&#60;/</font><font color="#800000">label</font><font color="#0000ff">&#62;&#60;</font><font color="#800000">asp:TextBox</font> <font color="#ff0000">ID</font><font color="#0000ff">="EmailText"</font> <font color="#ff0000">runat</font><font color="#0000ff">="server"</font><font color="#0000ff">&#62;&#60;/</font><font color="#800000">asp:TextBox</font><font color="#0000ff">&#62;</font><br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">label</font><font color="#0000ff">&#62;</font>Secret Phrase: <font color="#0000ff">&#60;/</font><font color="#800000">label</font><font color="#0000ff">&#62;</font> <font color="#0000ff">&#60;</font><font color="#800000">asp:TextBox</font> <font color="#ff0000">ID</font><font color="#0000ff">="SecretPhraseText"</font> <font color="#ff0000">runat</font><font color="#0000ff">="server"</font><font color="#0000ff">&#62;&#60;/</font><font color="#800000">asp:TextBox</font><font color="#0000ff">&#62;</font><br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">label</font><font color="#0000ff">&#62;</font>&#38;nbsp<font color="#0000ff">&#60;/</font><font color="#800000">label</font><font color="#0000ff">&#62;</font> <font color="#0000ff">&#60;</font><font color="#800000">input</font> <font color="#ff0000">id</font><font color="#0000ff">="forgot"</font> <font color="#ff0000">type</font><font color="#0000ff">="button"</font> <font color="#ff0000">value</font><font color="#0000ff">="Forget password"</font> <font color="#ff0000">class</font><font color="#0000ff">="button"</font> <font color="#ff0000">onclick</font><font color="#0000ff">="onForgotPasswordClick()"</font><font color="#0000ff">/&#62;</font>&nbsp; <br>&nbsp;&nbsp;<font color="#0000ff">&#60;/</font><font color="#800000">div</font><font color="#0000ff">&#62;</font><br>&nbsp;&nbsp;<font color="#0000ff">&#60;</font><font color="#800000">span</font> <font color="#ff0000">id</font><font color="#0000ff">="Password"</font><font color="#0000ff">&#62;&#60;/</font><font color="#800000">span</font><font color="#0000ff">&#62;</font><br><font color="#0000ff">&#60;/</font><font color="#800000">asp:Content</font><font color="#0000ff">&#62;</font><br></font><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote>
<br />
<br />
By pressing on &#8216;forget&#8217; button onForgotPasswordClick() javascript function will be called (this is the place where we would do AJAX calls). Currently the code is really simple:
<br />
<br />
<blockquote><code><font size="2" face="Courier New" color="black"><font color="#0000ff">function</font> onForgotPasswordClick() {<br>&nbsp;&nbsp;WebApplication.Services.ForgetPassword.HelloWorld(onMethodSucceeded, onMethodFailed);<br>}<br><br><font color="#0000ff">function</font> onMethodSucceeded(results, args) {<br>&nbsp;&nbsp;alert(results);<br>}<br><br><font color="#0000ff">function</font> onMethodFailed(error) {<br>}<br></font><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote>
<br />
<br />
One one line of code in onForgotPasswordClick() do a bit complex things. It register a call to web service (you have to reference web service with a full class name), HelloWorld does not have any arguments, so we are passing nothing, but register 2 callback functions. One that will be called on successfull finish of AJAX call, second will be called on any failure. Even it might seems no so &#8216;magic&#8217; ones who created AJAX application without any frameworks would notice how less code have to be created to accomplish this. Finally, we displaying results in alert window. Just run application, click &#8216;Forgot password&#8217; button and see:
<br />
<br />
<a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://2.bp.blogspot.com/_stL4bIIuRUs/TCZ5086ObnI/AAAAAAAAG1Q/Rd-q5Uhr68k/s1600/helloworld.png"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 251px;" src="http://2.bp.blogspot.com/_stL4bIIuRUs/TCZ5086ObnI/AAAAAAAAG1Q/Rd-q5Uhr68k/s400/helloworld.png" border="0" alt=""id="Img1" /></a>
<br />
<br />
<h2>Real work</h2>
<br />
As soon as we see its OK, let&#8217;s do some real work. If users email and secret pharase matches corresponding record in database, we going to show user password on screen without reloading of page. We will add new business object and implementation for recovery of password. I would just paste tests and code of business object (as it is really small and simple one), the rest implementation you will be able to see by going to GitHub. (for ones who followed my previous articlies - I&#8217;ve done some refactoring switching to Repository pattern for DAL, since it is more correct and reusable way of working with data, please see details in code).
<br />
<br />
Tests:
<br />
<blockquote><code><font size="2" face="Courier New" color="black"><font color="#0000ff">using</font> System;<br><font color="#0000ff">using</font> System.Collections.<font color="#2B91AF">Generic</font>;<br><font color="#0000ff">using</font> System.Linq;<br><font color="#0000ff">using</font> System.Text;<br><font color="#0000ff">using</font> NUnit.Framework;<br><font color="#0000ff">using</font> Company.Product.BLL.Tests.Mocks;<br><font color="#0000ff">using</font> NUnit.Framework.SyntaxHelpers;<br><font color="#0000ff">using</font> Company.Product.DAL;<br><br><font color="#0000ff">namespace</font> Company.Product.BLL.Tests<br>{<br>&nbsp;&nbsp;[TestFixture]<br>&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">class</font> ForgotPasswordTests<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;[Test]<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">void</font> Smoke()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//INIT</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> data = <font color="#0000ff">new</font> ForgotPasswordDataMock();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//ACT/POST</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> c = <font color="#0000ff">new</font> ForgotPassword(data);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;[Test]<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">void</font> RestorePassword_NoUser()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//INIT</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> data = <font color="#0000ff">new</font> ForgotPasswordDataMock();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> forgot = <font color="#0000ff">new</font> ForgotPassword(data);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//ACT</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> password = forgot.RestorePassword(<font color="#A31515">"no such user"</font>, <font color="#A31515">"secret"</font>);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//POST</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Assert.That(password, Is.Null, <font color="#A31515">"It is not possible to return password for non-existing user."</font>);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;[Test]<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">void</font> RestorePassword_WrongSecretPhrase()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//INIT</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> data = <font color="#0000ff">new</font> ForgotPasswordDataMock();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> forgot = <font color="#0000ff">new</font> ForgotPassword(data);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data.InsertUser(<font color="#0000ff">new</font> User() { Email = <font color="#A31515">"user@a.com"</font>, Password = <font color="#A31515">"password"</font>, SecretPhrase = <font color="#A31515">"correct secret"</font> });<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//ACT</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> password = forgot.RestorePassword(<font color="#A31515">"user@a.com"</font>, <font color="#A31515">"wrong secret"</font>);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//POST</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Assert.That(password, Is.Null, <font color="#A31515">"It is not possible to return password if wrong secret phrase used."</font>);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;[Test]<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">void</font> RestorePassword_CorrectUserAndSecret()<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//INIT</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> data = <font color="#0000ff">new</font> ForgotPasswordDataMock();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> forgot = <font color="#0000ff">new</font> ForgotPassword(data);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> expectedPassword = <font color="#A31515">"password"</font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data.InsertUser(<font color="#0000ff">new</font> User() { Email = <font color="#A31515">"user@a.com"</font>, Password = expectedPassword, SecretPhrase = <font color="#A31515">"correct secret"</font> });<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//ACT</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> password = forgot.RestorePassword(<font color="#A31515">"user@a.com"</font>, <font color="#A31515">"correct secret"</font>);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">//POST</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Assert.That(password, Is.EqualTo(expectedPassword), <font color="#A31515">"Wrong password value returned."</font>);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;}<br>}<br></font><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote>
<br />
<br />
Code:
<br />
<blockquote><code><font size="2" face="Courier New" color="black"><font color="#0000ff">using</font> System;<br><font color="#0000ff">using</font> System.Collections.<font color="#2B91AF">Generic</font>;<br><font color="#0000ff">using</font> System.Linq;<br><font color="#0000ff">using</font> System.Text;<br><font color="#0000ff">using</font> Company.Product.DAL;<br><br><font color="#0000ff">namespace</font> Company.Product.BLL<br>{<br>&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">class</font> ForgotPassword<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">private</font> IUsersRepository _data;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">public</font> ForgotPassword(IUsersRepository data)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_data = data;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">string</font> RestorePassword(<font color="#0000ff">string</font> email, <font color="#0000ff">string</font> secret)<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> user = _data.FindUserByEmail(email);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font> (user == <font color="#0000ff">null</font>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">return</font> <font color="#0000ff">null</font>;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">if</font> (user.SecretPhrase == secret)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">return</font> user.Password;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">return</font> <font color="#0000ff">null</font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;}<br>}<br></font><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote>
<br />
<br />
After it is ready and tested we are going to integrate with object to Web Service method call.
<br />
<br />
<blockquote><code><font size="2" face="Courier New" color="black"><font color="#008000">/// &#60;summary&#62;</font><br><font color="#008000">/// Summary description for ForgetPassword</font><br><font color="#008000">/// &#60;/summary&#62;</font><br>[WebService(Namespace = <font color="#A31515">"http://tempuri.org/"</font>)]<br>[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]<br>[System.ComponentModel.ToolboxItem(<font color="#0000ff">false</font>)]<br><font color="#008000">// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. </font><br>[System.Web.Script.Services.ScriptService]<br><font color="#0000ff">public</font> <font color="#0000ff">class</font> ForgotPasswordService : System.Web.Services.WebService<br>{<br>&nbsp;&nbsp;[WebMethod]<br>&nbsp;&nbsp;<font color="#0000ff">public</font> <font color="#0000ff">string</font> RestorePassword(<font color="#0000ff">string</font> email, <font color="#0000ff">string</font> secret)<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">var</font> forgotPassword = <font color="#0000ff">new</font> ForgotPassword(<font color="#0000ff">new</font> UsersRepository());<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">return</font> forgotPassword.RestorePassword(email, secret);<br>&nbsp;&nbsp;}<br>}<br></font><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote>
<br />
<br />
After that it is time to use Web Service from javascript code. I&#8217;m using <a href="http://jqueryui.com/">jQuery</a> library to work with divs, classes and so on. jQuery does not require any special to add about it, it is so popular that it has been included to VS 2010 and Microsoft is <a href="http://www.microsoft.com/Presspass/press/2010/mar10/03-16MIX10Day2PR.mspx">contributing</a> to jQuery as well. Code uses simple and cool effect of fadeOut slideDown effect, just to make application bit more attactive.
<br />
<br />
<blockquote><code><font size="2" face="Courier New" color="black"><font color="#0000ff">function</font> onForgotPasswordClick() {<br>&nbsp;&nbsp;<font color="#0000ff">var</font> email = $(<font color="#A31515">'#email'</font>).val();<br>&nbsp;&nbsp;<font color="#0000ff">var</font> secret = $(<font color="#A31515">'#secret'</font>).val();<br><br>&nbsp;&nbsp;$(<font color="#A31515">"#resultsdiv"</font>).fadeOut(<font color="#A31515">"fast"</font>, <font color="#0000ff">function</font>() {<br>&nbsp;&nbsp;&nbsp;&nbsp;removeClasses();<br>&nbsp;&nbsp;&nbsp;&nbsp;WebApplication.Services.ForgotPasswordService.RestorePassword(email, secret, onMethodSucceeded, onMethodFailed);&nbsp;&nbsp;<br>&nbsp;&nbsp;});&nbsp;&nbsp;<br>}<br><br><font color="#0000ff">function</font> onMethodSucceeded(results, args) {<br>&nbsp;&nbsp;<font color="#0000ff">var</font> password = results;<br><br>&nbsp;&nbsp;<font color="#0000ff">if</font> (password == <font color="#0000ff">null</font>) {<br>&nbsp;&nbsp;&nbsp;&nbsp;$(<font color="#A31515">"#results"</font>).addClass(<font color="#A31515">"red"</font>);<br>&nbsp;&nbsp;&nbsp;&nbsp;$(<font color="#A31515">"#results"</font>).html(<font color="#A31515">"Your email or secret phrase is invalid"</font>);&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;}<br>&nbsp;&nbsp;<font color="#0000ff">else</font> {<br>&nbsp;&nbsp;&nbsp;&nbsp;$(<font color="#A31515">"#results"</font>).addClass(<font color="#A31515">"green"</font>);<br>&nbsp;&nbsp;&nbsp;&nbsp;$(<font color="#A31515">"#results"</font>).html(<font color="#A31515">"Your password: "</font> + password);<br>&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;$(<font color="#A31515">"#resultsdiv"</font>).slideDown(<font color="#A31515">"fast"</font>);<br>}<br><br><font color="#0000ff">function</font> onMethodFailed(error) {<br>}<br><br><font color="#0000ff">function</font> removeClasses() {<br>&nbsp;&nbsp;<font color="#0000ff">if</font> ($(<font color="#A31515">"#results"</font>).hasClass(<font color="#A31515">"green"</font>)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;$(<font color="#A31515">"#results"</font>).removeClass(<font color="#A31515">"green"</font>);<br>&nbsp;&nbsp;} <font color="#0000ff">else</font> <font color="#0000ff">if</font> ($(<font color="#A31515">"#results"</font>).hasClass(<font color="#A31515">"red"</font>)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;$(<font color="#A31515">"#results"</font>).removeClass(<font color="#A31515">"red"</font>);<br>&nbsp;&nbsp;}<br>}<br></font><br><font size="1" color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font size="1" color="gray">Source Code Highlighter</font></a>.</font></code></blockquote><br />
<br />
<h2>Results</h2>
<br />
As soon as I input some wrong data into email/secret phase control, I&#8217;ll see fadding out div that informs me about problem. Like that,
<br />
<br />
<a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://2.bp.blogspot.com/_stL4bIIuRUs/TCZ6CkSb6rI/AAAAAAAAG1Y/zEBpoU-wqEw/s1600/real-forgetpass.png"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 252px;" src="http://2.bp.blogspot.com/_stL4bIIuRUs/TCZ6CkSb6rI/AAAAAAAAG1Y/zEBpoU-wqEw/s400/real-forgetpass.png" border="0" alt=""id="Img2" /></a>
<br />
<br />
But if I put correct values where, I&#8217;ll get my password back:
<br />
<br />
<a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://2.bp.blogspot.com/_stL4bIIuRUs/TCZ6PBrttTI/AAAAAAAAG1g/iiJV3ATah3o/s1600/real-forgetpasscorrect.png"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 252px;" src="http://2.bp.blogspot.com/_stL4bIIuRUs/TCZ6PBrttTI/AAAAAAAAG1g/iiJV3ATah3o/s400/real-forgetpasscorrect.png" border="0" alt=""id="Img3" /></a>
<br />
<br />
<h2>Conclusions</h2>
<br />
Nowadays it is even hard to imagine serious web application with out AJAX. It is mostly everywhere. Because of such usabilty and popularity a lot of vendors proposing tools and framework to hanlde common AJAX issues. And of cause, tools for working with AJAX is started to be included to .NET framework. ScriptManager is only one part of it framework. For futher exploration I would recomend to look on ASP.net AJAX Toolkit that is build upon .Net framework abilitites and propose a lot of interesting controls. Moreover, it is <a href="http://ajaxcontroltoolkit.codeplex.com/SourceControl/list/changesets">open source</a> and you can go ahead and hack it or contribute it.
<br />
<br />
<h2>Sources</h2>
<br />
<p>
Sources are available on GitHub: <a href="http://github.com/alexanderbeletsky/Concept">http://github.com/alexanderbeletsky/Concept</a>
</p>

<!-- AddThis Button BEGIN -->
<div><a expr:addthis:title='data:post.title' expr:addthis:url='data:post.url' class='addthis_button'><img src="http://s7.addthis.com/static/btn/v2/lg-share-en.gif" width="125" height="16" alt="Bookmark and Share" style="border:0"/></a>
<script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#username=xa-4c30246f249329c8"></script></div>
<!-- AddThis Button END --></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2010/06/gallio-runs-mbunit-tests-very-slowly.html">
    
      Gallio runs MbUnit tests very slowly?</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2010-06-18T18:28:00+03:00" pubdate data-updated="true">Jun 18<span>th</span>, 2010</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/tdd/'>TDD</a>, <a class='category' href='/blog/categories/tools/'>Tools</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
Currently I&#8217;m looking close to one interesting project called <a href="http://subtextproject.com/default.aspx?AspxAutoDetectCookieSupport=1">Subtext</a>. It being developed and managed by <a href="http://haacked.com/">Phil Haack</a> and recently he <a href="http://haacked.com/archive/2010/06/06/subtext-2-5-released.aspx">announced</a> release of version 2.5. It open-souce so anyone is able to get SVN snapshot and digg into code and 
    even to contribute to this project. I would like to do a separate blog post on Subtext, but now I want to touch another topic.
<br />
<br />
Subtext project uses <a href="http://www.mbunit.com/">MbUnit</a> test framework, that I have no chance to work before. So as my first goal I started to look for tools to work with MbUnit and ways of its integration to Visual Studio. Obvious choice was a <a href="http://www.gallio.org/">Gallio</a>. Gallio is open-source automation test framework, a bundle contains *maybe* all known unit-test systems (NUnit, MbUnit, NCover, TypeMock etc.) as well as add-on to Visual Studio that allows to run MbUnit tests by <a href="http://testdriven.net/">Testdriven.net</a> runner. 
<br />
<br />
I was preatty happy to find that one exists. I&#8217;ve installed the version that official page refered to Gallio v3.1 Update 2 build 397 - x86. Installed on VS 2008 no problem and I&#8217;ve started to play with Subtext tests. But I&#8217;ve noticed that it works very slow, namely run of particular test takes about 20 sec on my machine. That is too much time for ordinar test. At first I blamed Subtext that it performs test database initialization in [SetUp] function of test assembly. But I just commented out this initialization I saw that situation has not changed.
<br />
<br />
I googled a bit I found that Oliver Sturm also experienced same problem and did a post on his <a href="http://www.sturmnet.org/blog/2010/03/11/gallio-mbunit-very-slow">blog.</a> He did a great job and noticed that reason for such slow down was gallio.utility.exe application that hangs for about 20 sec on each start. Tests are using that for initialization so it slows down each start of tests. He had created a <a href="http://code.google.com/p/mb-unit/issues/detail?id=634">bug report</a> and as <a href="http://code.google.com/u/jeff.brown/">Jeff Brown</a> the problem was fixed for v3.2.380. I went to a <a href="http://ccnet.gallio.org/Distributables/">distribution site</a> and downloaded latest 3.2 vesrion. I&#8217;ve installed it and try to run test. Woow, it was run for 
    just a second! Good news I thought! But when I tried to run all tests from a test assembly I was disappointed that it simply does not work. It says about exception during initialization of Gallio. I reported on that with <a href="http://code.google.com/p/mb-unit/issues/detail?id=673">new issue</a> to Gallio.
<br />
<br />
I&#8217;ve decied to try earlier verions of 3.2.. But still had the same problem. So, 3.2 realease does not work on my machine at all and do not know the reason. My only choice was to back to 3.1 but try some more recent daily builds. I&#8217;ve got Version 3.1 build 514 and finally it started to work as expected. Test case run took about 4 seconds, slower that 3.2 456 but anyway, not so bad as for 3.1 397. 
<br />
<br />
Gallio is preatty good software, so I really recommed to to check it out. 3.1 514 works fine on Visual Studio 2008.  
<br />
<br />
Hope this one will be useful to one who is going to start with Gallio or met same problem as me.</div>

      
      
    </div>
  </div>

    </article>
  
  <div class="pagination inner pure-u-1">
    
      <a class="prev" href="/blog/page/20/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/18/">Newer &rarr;</a>
    
  </div>
</div></div>
	<footer class="pure-g-r"><div class="inner pure-u-1">
	<p>
		Theme by <a href="https://twitter.com/alexbeletsky">@alexbeletsky</a> | Fonts by <a href="http://www.google.com/fonts/">Google Fonts</a> | Icons by <a href="http://fontello.com/">Fontello</a> | Hosted on <a href="http://github.com">github</a> | Powered by <a href="http://octopress.org/">Octopress</a>
	</p>
	<p>
		Copyright © 2010 - 2013 beletsky.net
	</p>
</div>

</footer>
	<div class="buttons">
	


	
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>


	
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>


	
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


	

</div>
</body>
</html>

<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Alexander Beletsky's development blog</title>
  <meta name="author" content="Alexander Beletsky">

  
  <meta name="description" content="How to start using Git in SVN-based organization Jun 29th, 2011 Git, GitHub, GitSVN I&#8217;ve been using Git about a year now, immediately after &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://beletsky.net/blog/page/15/index.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/fontello.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/pure-min.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/style.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Alexander Beletsky's development blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:800' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Roboto:300' rel='stylesheet' type='text/css'>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-16388698-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>


<body>
	<header class="pure-g-r"><div class="pure-g-r">
	<div class="inner pure-u-1">
		<h4 class="light">Alexander Beletsky's development blog</h4>
		<h1><a href="/">My profession is engineering</a></h1>
		<nav role="navigation" class="pure-menu pure-menu-open pure-menu-horizontal light"><ul>
	<li><a href="/projects">Projects</a></li>
	<li><a href="/talks">Talks</a></li>
	<li><a href="/medium">Medium</a></li>
	<li><a href="/blog/archives">Archive</a></li>
	<li><a href="/about">About me</a></li>
</ul>

</nav>
	</div>
</div>

</header>
	<div class="social inner pure-menu-horizontal"><ul>
  <li>
    <a class="twitter icon-twitter" href="http://twitter.com/alexbeletsky"></a>
  </li>
  <li>
    <a
      class="github icon-github-circled"
      href="https://github.com/alexbeletsky"
    ></a>
  </li>
  <li>
    <a
      class="stackoverflow icon-stackoverflow"
      href="http://stackoverflow.com/users/386751/alexanderb"
    ></a>
  </li>
  <li>
    <a
      class="rss icon-rss"
      href="http://feeds.feedburner.com/abeletskyblog"
    ></a>
  </li>
</ul>
</div>
	<div id="content" class="inner pure-g-r"><div class="blog-index">
  
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/06/how-to-start-using-git-in-svn-based.html">
    
      How to start using Git in SVN-based organization</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-06-29T21:04:00+02:00" pubdate data-updated="true">Jun 29<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/git/'>Git</a>, <a class='category' href='/blog/categories/github/'>GitHub</a>, <a class='category' href='/blog/categories/gitsvn/'>GitSVN</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>
I&#8217;ve been using Git about a year now, immediately after creation my <a href="https://github.com/alexbeletsky">github</a> account. I got really nice impression of using this tool, but still - on my primary job at <a href="http://www.e-conomic.com/">e-conomic</a> we are using SVN as primary VCS tool.
</p>
<p>
You are probably aware about all good thing with Git. If you still don&#8217;t you might check out these great <a href="http://stackoverflow.com/questions/871/why-is-git-better-than-subversion">answers</a> on Stackoverflow. In short - Git adds benefits, but it adds complexity as well.
</p>
<p>
After a bit evaluation I found that those benefits are worth to stop using SVN and switch to Git. But, if you ask your colleagues &#8220;Are you ready to go with Git?&#8221; you would probably hear &#8220;No!&#8221;. It is clear why, people are getting used to current tools.. infrastructure are build around them. And switching from one VCS to another seemed as destruction of building fundament for many developers.
</p>
<p>
Fortunately, Git has a killer feature that other DVCS does not have! And this feature will help you to smoothly start with Git even if your company is still using SVN as standard. Yes, I&#8217;m talking about <a href="http://www.kernel.org/pub/software/scm/git/docs/git-svn.html">git-svn</a>.
</p>
<p>
Believe me, it is amazing! I always have a little distrust for such kind of integration tool, but so far it works as charm. So, I&#8217;ll give you a small instructions that will make you possible to get to your office tomorrow and start use Git as your own VCS.
</p>
<h2>Setup you environment</h2>
<ul>
<li>
Download and install <a href="http://code.google.com/p/msysgit/downloads/detail?name=Git-1.7.4-preview20110204.exe&can=2&q=">msysgit</a>
</li>
<li>
Setup local user information, example
<pre>
    git config --global user.name “alexander.beletsky”
    git config --global user.email “alexander.beletsky@gmail.com”
</pre>
</li>
<li>
If you are on Windows and doing only-Windows development, it is recommended to turn off <code>autocrlf</code>
<pre>
    git config core.autocrlf false
</pre>
</li>
</ul>
<h2>Checking out code from SVN repository</h2>
<ul>
<li>
Run git clone command (it might take some time, depending on repository and history size)
<pre>
    git svn clone https://mysvnserver/repo
</pre>
</li>
</ul>
<p>
As clone finished, you will see that new folder <code>repo</code> created with the content of your SVN repository. Now, this folder is actually Git repository + you local sources copy. Try to run <code>git log</code> inside the repository and you will see that all your history are there!
</p>
<h2>Let&#8217;s do some work</h2>
<p>
Now, suppose you start to work on some bugfix. By default, git repository contains one branch called <code>master</code>. Good style is do not do direct commits into master at all, just keep it as synchronization point between SVN repository and your local repository. So, to do actual job you to create branch.
</p>
<pre>
    git checkout -b bugfix-id-1453
</pre>
<p>
This command will create new branch called <code>bugfix-id-1453</code> and immediately switch to it. If you haven&#8217;t noticed how that happened - please welcome to git&#8217;s high performance world.
</p>
<p>
You changed some file and ready to commit. In git it&#8217;s a 2 steps operation. First, you need to put content to stage.. second, you store the content in new commit object.
</p>
<pre>
    git add .
    git commit -m "issue has been fixed"
</pre>
<h2>Commit changes back to SVN</h2>
<p>
You&#8217;ve fixed a bug and now fixed is placed in <code>bugfix-id-1453</code>. But you should give it back to rest of the world.
</p>
<p>
Checkout your master branch:
</p>
<pre>
    git checkout master
</pre>
<p>
Get the latest changes from SVN:
</p>
<pre>
    git svn rebase
</pre>
<p>
Now SVN server and local master branch are identical. We have to merge our fix into master:
</p>
<pre>
    git merge bugfix-id-1453
</pre>
<p>
Now master contains previous SVN state + new fix. We have to synchronize local repository and SVN server:
</p>
<pre>
    git svn dcommit
</pre>
<h2>Conclusions</h2>
<p>
Git-svn is perfect tool to start using git without radical changes in organization. It gives everybody change to try it out, how much it really fits your needs. I&#8217;m having a big pleasure now of working with Git. I&#8217;m not saying it&#8217;s ideal smooth process, sure I met some difficulties. But for me those difficulties are nothing comparing the benefits I&#8217;m getting with it.
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/06/thinking-about-cloud.html">
    
      Thinking about cloud..</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-06-22T09:09:00+02:00" pubdate data-updated="true">Jun 22<span>nd</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/cloud/'>Cloud</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<img src="http://t0.gstatic.com/images?q=tbn:ANd9GcStTBpwTeKUQEuBeVN6mrRWGCQD3B-2scSFb_Yro1HLzMvXPW5_" alt="cloud" />
<p>
I&#8217;m really inspired with cloud ideas since I first time met it. No doubt, that clouds are future of computing. I like the metaphor comparing cloud and electric power plant: &#8220;Last century if you plan your business depend on electricity, you have to afford huge and expensive electric generator - you have to host it, support it and do all maintenance stuff by yourself. You pay for everything by yourself, just to be able to plug one device. Then power plant come and electric wires covered a country, you no longer need your own electric generator, you can buy the electricity from power plant station. You pay only for that you used and it is much cheeper, since a lot of people using it together with you&#8221;. Clouds are modern power plants - to be online you no longer need to buy servers, establish a data center, maintenance all infrastructure. You could by the resources from cloud services provider. 
</p>
<p>
Clouds are about to change the business. It is much more easy to start-up new product in web, since you have to care only about product, not infrastructure. I knew some companies in past with quite good ideas, but those ideas buried under infrastructure complexity and expensiveness. And the clouds are about to solve that problem, microISV should be happy about.
</p>
<p>
I was thinking about all my current and future products are going to in cloud for sure. First and obvious point to look was Microsoft Azure. But after some elaboration I disappointed a bit: 
</p>
<ol>
<li>Azure is overcomplicated. I&#8217;m not saying I&#8217;m not able to understand that.. But all those Roles, Processes, Blobs - it is just too much details. But what I basically waht is to place my <a href="http://trackyt.net">existing</a> working product into elastic space, that&#8217;s it.
</li>
<li>
It is still expensive. This Azure price calculator, my simplest configuration would be ~50 USD/month. This is more than I currently pay for VPS.
</li>
</ol>
<p>
So, I saw not enough reasons to switch immediately. 
</p>
<p>
Yesterday, I&#8217;ve been contacted by <a href="http://www.host1plus.com/">Host1Plus</a> company. They started out beta cloud in the new datacenter which is located in Frankfurt Main, Germany. And they are looking for beta testers of new service. The proposition looks really fine to me, since I could try the power of clouds and in the same time help a company with a feedback I could provide.  
</p>
<p>
I&#8217;m going to join. If it is interesting for you, join with me. Here is some links that could be helpful:
</p>
<ul>
<li><a href="http://www.host1plus.com/press/beta-cloud-vps-will-be-launched-by-host1plus/">http://www.host1plus.com/press/beta-cloud-vps-will-be-launched-by-host1plus/</a> press release about it</li>
<li><a href="http://www.host1plus.com/beta-invitations/">http://www.host1plus.com/beta-invitations/</a> mailing list for all the beta testers who wants to join the campaign</li>
<li><a href="http://www.host1plus.com/forum/">http://www.host1plus.com/forum/</a> the community forum where all beta testers can join to start the discussions</li>
</ul></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/06/inside-aspnet-mvc-all-begins-here.html">
    
      Inside ASP.NET MVC: All begins here - MvcHanlder</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-06-18T17:46:00+02:00" pubdate data-updated="true">Jun 18<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/insidemvc/'>InsideMVC</a>, <a class='category' href='/blog/categories/mvc/'>MVC</a>, <a class='category' href='/blog/categories/asp-dot-net/'>asp.net</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>
<a href="http://www.beletsky.net/2011/06/inside-aspnet-mvc-route-to-mvchanlder.html">Last time</a> we explored a way of HTTP request from the IIS up to <code>MvcHanlder</code>. Then <code>UrlRouting</code> module match URL we registered in <code>Application_Start()</code>, it gets corresponding <code>IRouteHandler</code> class and calls for <code>GetHttpHandler</code> method. In ASP.NET MVC URL <code>IRouteHandler</code> interface is implemented by <code>MvcRouteHandler</code> class which return <code>MvcHanlder</code> instance. The actual MVC story begins exactly in <code>MvcHanlder</code> internals.
</p>
<h2>Generic overview</h2>
<p>
We know that HttpHandlers are special objects that handles requests and produce a response. <code>MvcHanlder</code> produce nothing by itself. Instead, it uses <code>ControllerBuilder</code> object for creating <code>Controller</code> and call controller <code>Execute</code> method. It is <code>Execute</code> method responsibility to find corresponding action, call action and wrap action return result it HTTP response.
</p>
<a href="https://lh5.googleusercontent.com/-oJHL461Fj-w/TfzI2KJsFaI/AAAAAAAAHe0/MDVtQS77gGw/handler.declaration.1.png">
<img src="https://lh5.googleusercontent.com/-oJHL461Fj-w/TfzI2KJsFaI/AAAAAAAAHe0/MDVtQS77gGw/handler.declaration.1.png" alt="mvc handler declaration" />
</a>
<p>
As you can see, it implements 3 interfaces: <code>IHttpHandler</code>, <code>IHttpAsyncHandler</code> and <code>IRequiresSessionState</code>. The handler could operate in 2 modes: sync and async, depending on caller. ASP.NET frameworks <code>ProcessRequestInternal</code> method try to utilize asynchronous mode of work first.
</p>
<p>
The constructor of <code>MvcHanlder</code> receives <code>RequestContext</code> class, that is part of System.Web.Routing and contains information about <code>HttpContext</code>.  
</p>
<h2>Synchronous and Asynchronous modes</h2>
<p>
Of course, the details of operation in synchronous and asynchronous modes are differ from each other, but main algorithm of work is exactly the same.. Let&#8217;s first see how it operates in sync mode.
</p>
<h2>Process the request</h2>
<p>
Due to <code>IHttpHandler</code> interface, <code>MvcHanlder</code> expected to support one property and one method:
</p>
<a href="https://lh4.googleusercontent.com/-GCULpCDs5Uk/TfzI1RGGfpI/AAAAAAAAHeo/XZ3FTPT_jMI/handler.declaration.2.png">
<img src="https://lh4.googleusercontent.com/-GCULpCDs5Uk/TfzI1RGGfpI/AAAAAAAAHeo/XZ3FTPT_jMI/handler.declaration.2.png" alt="mvc handler declaration" />
</a>
<p>
<code>IsReusable</code> is always false, meaning that for each request the runtime would create new instance of handler. <code>ProcessRequest</code> receives <code>HttpContext</code> and basically delegates call to internal <code>ProcessRequest</code> method.
</p>
<a href="https://lh3.googleusercontent.com/-D3MUti1Eh7g/TfzI3RIRXXI/AAAAAAAAHe8/ADmoHG1wnQo/handler.declaration.3.png">
<img src="https://lh3.googleusercontent.com/-D3MUti1Eh7g/TfzI3RIRXXI/AAAAAAAAHe8/ADmoHG1wnQo/handler.declaration.3.png" alt="mvc handler declaration" />
</a>
<p>
Notice to the first line.. <code>HttpContext</code> is being wrapped with <code>HttpContextWrapper</code> and casted to <code>HttpContexBase</code>. Rest of code never (mostly) using <code>HttpContext</code> directly, but through <code>HttpContexBase</code>. The <code>HttpContexBase</code> have been introduced to improve testability of ASP.NET applications, since <code>HttpContext</code> is unable to be mocked.
</p>
<h2>ControllerBuilder, ControllerFactory, Controller</h2>
<p>
Let&#8217;s see inside the <code>ProcessRequest</code> method to see how exactly the controller is being constructed and called.
</p>
<a href="https://lh5.googleusercontent.com/-hGQmALFmXyw/TfzI1BGwhQI/AAAAAAAAHek/Ts_T-BAo85U/handler.declaration.4.png">
<img src="https://lh5.googleusercontent.com/-hGQmALFmXyw/TfzI1BGwhQI/AAAAAAAAHek/Ts_T-BAo85U/handler.declaration.4.png" alt="mvc handler declaration" />
</a>
<p>
The call is wrapped with a little security handler, that would do perform the check for Trust settings, before calling internal action. Inside the action <code>IController</code> and <code>IControllerFactory</code> are being declared and initialized in <code>ProcessRequestInit</code> method.
</p>
<a href="https://lh4.googleusercontent.com/-8WV5t8II9XU/TfzI1qyxG8I/AAAAAAAAHes/PB4NiaWZJts/handler.declaration.5.png">
<img src="https://lh4.googleusercontent.com/-8WV5t8II9XU/TfzI1qyxG8I/AAAAAAAAHes/PB4NiaWZJts/handler.declaration.5.png" alt="mvc handler declaration" />
</a>
<p>
First, it puts MVC version information into HTTP response header, removes optional parameters from routes (one we mark with <code>UrlParameter.Optional</code>) and gets the name of controller from <code>RequestContext</code>. Remember, in global.asax we define URL pattern like &#8220;{controller}/{action}/{index}&#8221;, so in case of such URL <code>products/search/122</code> the <code>GetRequiredString</code> will return &#8220;products&#8221;.
</p>
<p>
<code>ControllerBuilder</code> is a singleton and factory method that creates <code>IControllerFactory</code> instance. 
</p>
<p>
<code>ControllerFactory</code> is responsible for creation of controller by given name. 
</p>
<p>
The <code>ProcessRequestInit</code> gets the factory from <code>ControllerBuilder</code>, ask factory to create controller by the name from URL and returns results back to <code>ProcessRequest</code>.
</p>
<p>
Here we also could see good example of comments that lies.. &#8220;// Instantiate the controller and call Execute&#8221; - maybe sometime ago that was true, but not its false since Execute is not called here. 
</p>
<h2>Execution</h2>
<p>
As soon as controller factory and controller are successfully created, <code>ProcessRequest</code> calls for controller <code>Execute</code> method. Now, it is controller responsibility to produce the output and we will see how it does that in next &#8220;Inside MVC&#8221; posts. Execution is wrapped inside <code>try / finally</code> block and finalize code will release the controller by calling <code>ReleaseContoller</code> method of factory.
</p>
<h2>Meanwhile in Asynchronous&#8230;</h2>
<p>
In async world the things are bit more complex. There are no one single method, but 2 instead. <code>BeginProcessRequest</code> and <code>EndProcessRequest</code>.
</p>
<p>
The request initialization and creation of factory and controller is exactly the same. The difference in execution, for async controller 2 delegates are being created, 
</p>
<a href="https://lh3.googleusercontent.com/--qjZrorgG88/TfzI1xDv_dI/AAAAAAAAHew/RvZm0UMDQ8k/handler.declaration.7.png">
<img src="https://lh3.googleusercontent.com/--qjZrorgG88/TfzI1xDv_dI/AAAAAAAAHew/RvZm0UMDQ8k/handler.declaration.7.png" alt="mvc handler declaration" />
</a>
<p>
In fact, that than the request execution begins, <code>beginDelegate</code> is called that would call <code>BeginExecute</code> of the controller. At the end of request <code>endDelegate</code> called that would call <code>EndExecute</code> of controller.
</p>
<h2>What about tests?</h2>
<p>
That was a great surprise to me that <code>MvcHandler</code> is well unit tested. All aspects of its work are covered with corresponding tests.. I&#8217;ve heard a lot of developers complains like, &#8220;oh, it is so low-level code.. could not test it&#8221;. But MVC team, proof it is wrong. <code>HttpContexBase</code> could be easy mocked, so no excuse of not writing unit tests for modules/handlers. As I said in into, test code is really clean, following AAA principle&#8217;s, so I got a lot of pleasure of looking inside.
</p>
<p>
BTW, they are using <a href="http://code.google.com/p/moq/wiki/QuickStart">Moq</a> framework for mocking, that I personally like as well :).
</p>
<p>
Previous: <a href="http://www.beletsky.net/2011/06/inside-aspnet-mvc-route-to-mvchanlder.html">Inside ASP.NET MVC: Route to MvcHandler</a>
Next: <a href="http://www.beletsky.net/2011/07/inside-aspnet-mvc-controllerbuilder.html">Inside ASP.NET MVC: ControllerBuilder class</a>
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/06/candidatenet-application-i-made-on.html">
    
      Candidate, Application I Made on Hackatone</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-06-13T18:26:00+02:00" pubdate data-updated="true">Jun 13<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/candidate/'>Candidate</a>, <a class='category' href='/blog/categories/hackatone/'>Hackatone</a>, <a class='category' href='/blog/categories/open-source/'>Open source</a>, <a class='category' href='/blog/categories/asp-dot-net/'>asp.net</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>Here is quick description of application application I made on <a href="http://www.beletsky.net/2011/06/hackatone-in-kiev-11-12-june.html">Hackatone</a> this weekend. </p><p>Candidate.net is just working name for the project that I&#8217;m going to change as soon as I got better idea :). It supposed to be a kind of service that provides integration with your github repositories and provides a Continues Deployment cycle for that repositories. Namely, every code change that being pushed to github is immediately build, tested and deployed, so the time between code push and production is very short excludes any manual work. </p><p>I&#8217;ve spent ~16 hours for building up this application, sure I haven&#8217;t managed to make it as a service.. but - during the process I&#8217;ve changed my vision for project, so first I would like to create good continues build engine (like Team City or Jenkins) and base my future service on top of it (yeah, I already got some further plans :). </p><p>Technologies behind: </p><ul><li>ASP.NET MVC3</li>
<li>jQuery + some small pluggins</li>
<li>UppercuT build framework</li>
</ul><p>A picture says 1000 words, so here my little screencast of Candidate.net in action. It demonstrates the ability of setting up new application and hooking github push requests to build new application instance. </p><iframe src="http://www.screenr.com/embed/X48s" width="560" height="345" frameborder="0"></iframe> <p>Source code is hosted on github <a href="https://github.com/alexbeletsky/candidate">https://github.com/alexbeletsky/candidate</a>. Don&#8217;t forget it is really early prototype, the code is in big mess now.. I&#8217;m going to improve it much soon, so please keep watching repository. </p><p>I had a lot of fun of building this and have a better vision of how the application should look like. Hope to share it soon. I would be happy to hear some feedback on this.. and of cause you are free to fork repo and make your improvement (especially in UI/UX :). </p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/06/hackatone-in-kiev-11-12-june.html">
    
      Hackatone in Kiev 11-12 June</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-06-13T13:44:00+02:00" pubdate data-updated="true">Jun 13<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/hackatone/'>Hackatone</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>
This weekend I&#8217;ve been visiting very interesting event - <a href="http://www.developers.org.ua/calendar/615/">Hackatone</a> that took place in <a href="http://www.ciklum.net/">Ciklum</a> office. Hackatone is whole night hacking session there every team or person could came up with any idea, implement it and present to crowd. Many times I heard about similar events either in podcasts or blogs that I read.. but never tried that myself. Thank&#8217;s for <a href=""http://www.developers.org.ua/">DOU</a> enthusiasts I got opportunity to try that. Here is my report of that event. There would be some mix of English and Russian language, hope that would not make you confuse :)
</p>
<p>
The event began with common meeting there people were sharing ideas of applications they are going to build. During my pretty long journey with in <a href="http://www.beletsky.net/2011/05/continuous-production-make-it-work.html">Continues Production</a> I already got my idea - I wanted to build Deployment-as-Service product that easily integrated with github and utilizes power of UppercuT for building .NET web applications. There was very few .NET developers there, already having their own ideas to build.. so I went alone. 
</p>
<p>
If you have been to Ciklum office, you probably know what SkyPoint is.. It is 20-th floor in office that resides on one Kiev&#8217;s hills, so you might imagine this exceptional view from there. I grabbed a chair started to work. 
</p>
<p>
Due to experience I got with .NET deployments and Jenkins I had pretty much well understanding what the workflow should be. I&#8217;ve created ASP.NET MVC3 in my Visual Studio and stared to develop. The scope of work I planned to do was pretty much big and I a little nervous about my ability to finish everything. I tried to work as fast as I can.. Full hour, that 10 minutes break and full hour again. Maybe because of that creative atmosphere around or straight orientation on final result but I think I really got a <a href="http://en.wikipedia.org/wiki/Flow_(psychology)">Flow</a>..
</p>
<p>
So, after ~3 hour of work I&#8217;ve created my github repository for new project - Candidate.net:
</p>
<a href="http://twitter.com/#!/alexbeletsky/status/79592735673303040">
<img src="https://lh5.googleusercontent.com/-EB45A9ltPj4/TfX3yjW1xBI/AAAAAAAAHeQ/6flibleXfdk/tweet-github.png" alt="tweet" />
</a>
<p>
Keeping that rhythm I continued to work mostly till 3.00 AM.. About 60% of work were done. I felt a little tired and decided to stop for today and had a good sleep to continue tomorrow. My plans were ruined as soon as I stepped to 19th there people gathered together.. So, in 5 minutes I got several shots of cognac and was sitting on a floor with guitar in my hands :). I had a real fun and relax there. Haven&#8217;t noticed at all how 2 hours are gone and sun started to rise.. We had a really nice moment of meeting new day on staying on office balcony. 
</p>
<a href="http://twitter.com/#!/alexbeletsky/status/79730442869293056">
<img src="https://lh5.googleusercontent.com/-YoDuw9t7AxU/TfX3yt71IQI/AAAAAAAAHeI/GZ-utUiR0IQ/tweet-morning.png" alt="tweet" />
</a>
<p>
I have to continue the implementation, so I went back to SkyPoint and run my Visual Studio again. Of cause I could not get such rhythm as I got yesterday, the process were much slower. I had to refuse of several more ideas I wanted to build, ignore the rules of Clean Code, SOLID and DRY. Did some ugly tricks, just to make application work. I had issues with testing and deployment since WiFi connection were quite slow. But, long story short - I implemented very basic workflow and realized that would be it for presentation.
</p>
<a href="http://twitter.com/#!/alexbeletsky/status/79814256295550976">
<img src="https://lh5.googleusercontent.com/--LWi6MlSOjo/TfX3ysS1-WI/AAAAAAAAHeM/XdE5KC4fx5w/tweet-done.png" alt="tweet" />
</a>
<p>
I found a sofa and finally got a change to have a sleep. Don&#8217;t know why but I managed to sleep only for one hour, just woke up and could not sleep again. So, I had a shower (yes, there are showers in Ciklum office), coffee.. and very nice breakfast. I had some time before presentation began, so I re-tested my application several times more and was happy about results. 
</p>
<p>
At 15.00 PM presentations began! I showed Candidate.net ability to initialize new application, build and deploy it in minutes.. How you can deliver with just a push a code to github, the rest of job done by Candidate. I don&#8217;t think I really impress people there, because of .NET crowd were to small.. but I tried to do best. After the presentation I&#8217;ve been contacted by several guys who interested with such concept.
</p>
<p>
Most of the presented projects were either old-school games implemented with new technologies or mobile applications. One guys did a nice linux kernel exploration and share his ideas. 
</p>
<p>
After there was a manual voting for each project to decide on 3 best, I didn&#8217;t win :). Winners got their congratulations and presents for sponsors. I quit really quickly since I was a little late for my friend wedding that was that day :) 
</p>
<p>
That was really nice experience for me. I appreciate <a href="http://www.ciklum.net/">Ciklum</a>, <a href=""http://www.developers.org.ua/">DOU</a> and everyone involved, who make that possible. Thank you guys :)
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/06/inside-aspnet-mvc-route-to-mvchanlder.html">
    
      Inside ASP.NET MVC: Route to MvcHandler</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-06-06T09:28:00+02:00" pubdate data-updated="true">Jun 6<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/insidemvc/'>InsideMVC</a>, <a class='category' href='/blog/categories/mvc/'>MVC</a>, <a class='category' href='/blog/categories/asp-dot-net/'>asp.net</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>
In my <a href="http://www.beletsky.net/2011/05/inside-aspnet-mvc-setting-up-project.html">previous post</a> I promised to start with exploration of <code>MvcHanlder</code> as entry point of ASP.NET MVC application. <code>MvcHandler</code> plays the major role in MVC infrastructure, but as I fugured out - the whole story does not begin there. The story is actually begins inside ASP.NET framework.
</p>
<h2>ASP.NET framework</h2>
<p>
ASP.NET framework is heart of ASP.NET MVC application. Basically, ASP.NET is a request processing engine. It takes incoming request as input and sends it through <i>internal pipeline</i> till the <i>end point</i>. The architecture allows extensibility, you could plug either into pipeline (modules) or end points (handlers). Interesting fact that ASP.NET designed to be decoupled from actual request source. So, the source of request could be any application - IIS, Cassini or any custom one.
</p>
<p>
We could imagine that each request pass through the set of filters (<i>internal pipeline</i>) lands up on request handler (<i>end point</i>), request handler creates a response object and sent it back. There are a lot of hidden details of dealing with managed/unmanaged code that you could find in this <a href="http://www.west-wind.com/presentations/howaspnetworks/howaspnetworks.asp">brilliant article</a> by Rick Strahl. 
</p>
<p>
For us it is important to understand two basic abstractions, HttpModules and HttpHandlers.
</p>
<h2>HttpModules and HttpHandlers</h2>
<p>
From the developers point of view the difference between those are: one implements <code>IHttpModule</code> interface another implements <code>IHttpHandler</code> interface. 
</p>
<p>
<strong>Module</strong> participates in the request processing of every request in order to change or add to it in some way.  
</p>
<p>
<strong>Handler</strong> is responsible for handling the request and producing the response for specific content types.  
</p>
<p>
ASP.NET MVC is HttpHandler. 
</p>
<a href="https://lh3.googleusercontent.com/-8EBxpoh7R0w/Tex-Zo80FfI/AAAAAAAAHc8/eMI-FEEurCg/mvchandler.png">
<img src="https://lh3.googleusercontent.com/-8EBxpoh7R0w/Tex-Zo80FfI/AAAAAAAAHc8/eMI-FEEurCg/mvchandler.png" alt="MVC handler" />
</a>
<p>
There a bunch of default HttpModules and HttpHandlers in your IIS configuration. Just take a look here - %WINDOWS%\Microsoft.NET\Framework\v4.0.30319\Config\web.config. 
</p>
<p>
But if you look closer you won&#8217;t notice any mention of <code>System.Web.Mvc.MvcHanlder</code>. Hey. what&#8217;s wrong? How the runtime actually knows that <code>MvcHanler</code> have to be called to handle our request? That was absolutely unclear to me at very beginning. 
</p>
<h2>From request to handler</h2>
<p>
I opened WebRuntime.sln and found all references to <code>MvcHandler</code>. It is only one place there, in the <code>MvcRouteHandler</code> (MvcRouteHandler.cs) class. MvcRouteHandler implements <code>IRouteHandler</code> interface, with one single method <code>GetHttpHandler</code>. I put the breakpoint there and started application for debug.
</p>
<a href="https://lh6.googleusercontent.com/-qcToxPI6g3o/Tex-ZsGfgdI/AAAAAAAAHdA/9SLS0GaX5GQ/mvcroutehandler.get.png">
<img src="https://lh6.googleusercontent.com/-qcToxPI6g3o/Tex-ZsGfgdI/AAAAAAAAHdA/9SLS0GaX5GQ/mvcroutehandler.get.png" alt="MVC route handler" />
</a>
<p>
As application got started I halted on breakpoint with such call stack:
</p>
<a href="https://lh4.googleusercontent.com/-95WwV5VbvNA/Tex-ZV9WcgI/AAAAAAAAHc4/RK9EdEXJS3E/s912/gethandler.debug.png">
<img src="https://lh4.googleusercontent.com/-95WwV5VbvNA/Tex-ZV9WcgI/AAAAAAAAHc4/RK9EdEXJS3E/s912/gethandler.debug.png" alt="MVC debug" />
</a>
<p>
Let&#8217;s try to read and decrypt it.
</p>
<p>
It begins with <code>WebDev.WebHost40.dll</code> (Cassini Web Server) that receives request and <code>System.Web.HttpRuntime.ProcessRequest</code>. Here is ASP.NET framework start to work:  
</p>
<ol>
<li>
<strong>ProcessRequestInternal</strong> method called. This is the primary method of whole pipeline. First, it initialize the <code>HttpContext</code> object.
</li>
<a href="https://lh5.googleusercontent.com/-T9pgTJlG10Q/Tex-Z8zRAGI/AAAAAAAAHdM/duxzWFuPwy0/processrequestinternal.1.png">
<img src="https://lh5.googleusercontent.com/-T9pgTJlG10Q/Tex-Z8zRAGI/AAAAAAAAHdM/duxzWFuPwy0/processrequestinternal.1.png" alt="System.Web.Dll ProcessRequestInternal"/>
</a>
<li>
Next it get <code>HttpApplication</code> instance, initialize it and calls either <code>BeginProcessRequest</code> for <code>IHttpAsyncHandler</code> or <code>ProcessReques</code> for <code>IHttpHandler</code>. 
</li>
<a href="https://lh5.googleusercontent.com/-E2zMvxF0Kjs/Tex-Z399b2I/AAAAAAAAHdE/uuZWDF99pLg/processrequestinternal.2.png">
<img src="https://lh5.googleusercontent.com/-E2zMvxF0Kjs/Tex-Z399b2I/AAAAAAAAHdE/uuZWDF99pLg/processrequestinternal.2.png" alt="System.Web.dll GetApplicationInstance"/>
</a>
<li>
If I go to <code>global.asax.cs</code> of our application it is clear that <code>System.Web.HttpApplication</code> implementation is inherited and <code>System.Web.HttpApplication</code> is a usual <code>IHttpAsyncHandler</code>. So, async <code>BeginProcessRequest</code> starts.
</li>
<a href="https://lh3.googleusercontent.com/-o9FWdeP1IRk/Tex-ZYGZAmI/AAAAAAAAHcw/M9vfv2DB6EM/httpapplication.png">
<img src="https://lh3.googleusercontent.com/-o9FWdeP1IRk/Tex-ZYGZAmI/AAAAAAAAHcw/M9vfv2DB6EM/httpapplication.png" alt="HttpApplication"/>
</a>
<li>In <code>BeginProcessRequest</code> there is a cycle that iterates all modules and execute each of it. Reflector code looks messy, but the point is clear</li>
<a href="https://lh5.googleusercontent.com/-9wj99HDJiOM/Tex-ZEIIEqI/AAAAAAAAHcs/DV6Qy3ewRMM/execute.steps.png">
<img src="https://lh5.googleusercontent.com/-9wj99HDJiOM/Tex-ZEIIEqI/AAAAAAAAHcs/DV6Qy3ewRMM/execute.steps.png" alt="System.Web.dll ExecuteSteps"/>
</a>
<li>And finally, the control goes to <strong>UrlRoutingModule</strong> that calls our factory method for <code>MvcHandler</code>. Aha!</li>
</ol>
<h2>UrlRouting module</h2>
<p>
UrlRouting is an HttpModule, registered in global web.config:
</p>
<a href="https://lh3.googleusercontent.com/-tb3Q5OzOn2k/Tex-aX1BawI/AAAAAAAAHdU/4AFsqAMjD_A/urlrouting.register.png">
<img src="https://lh3.googleusercontent.com/-tb3Q5OzOn2k/Tex-aX1BawI/AAAAAAAAHdU/4AFsqAMjD_A/urlrouting.register.png" alt="UrlRouting register"/>
</a>
<p>
The goal of this module is basically matching incoming request by URL with pre-defined Route configuration and return corresponding handler for this request. In <code>PostResolveRequestCache</code> method it gets the RouteHandler and asks for corresponding HttpHanlder. 
</p>
<a href="https://lh4.googleusercontent.com/-n1rd7SudO7k/Tex-aBhr-tI/AAAAAAAAHdQ/XaEaL3dPmJY/urlrouting.postresolve.png">
<img src="https://lh4.googleusercontent.com/-n1rd7SudO7k/Tex-aBhr-tI/AAAAAAAAHdQ/XaEaL3dPmJY/urlrouting.postresolve.png"/>
</a>
<p>
Wow, I didn&#8217;t know that!.. UrlRouting plays a major role inside the MVC infrastructure. But there the Routes are initialized and how <code>MvcRouteHandler</code> is associated with request?
</p>
<h2>Back to roots - Application_Start() method</h2>
<p>
I should actually start from here, <code>Application_Start()</code> is entry point of application. By my journey turn to be just other way around.
</p>
<a href="https://lh3.googleusercontent.com/-BTvRzBgusNQ/Tex-Y-X7yrI/AAAAAAAAHcg/0FJT4hP1FM4/applicationstart.png">
<img src="https://lh3.googleusercontent.com/-BTvRzBgusNQ/Tex-Y-X7yrI/AAAAAAAAHcg/0FJT4hP1FM4/applicationstart.png" alt="Application_Init()"/>
</a>
<p>
Inside the <code>RegisterRoutes</code> we register route by giving: route name and constraints.
</p>
<a href="https://lh5.googleusercontent.com/-iKaDvwunU-M/Tex-ZftTanI/AAAAAAAAHc0/6ssXZ32Zva0/maproute.png">
<img src="https://lh5.googleusercontent.com/-iKaDvwunU-M/Tex-ZftTanI/AAAAAAAAHc0/6ssXZ32Zva0/maproute.png" alt="MVC map route"/>
</a>
<p>
The <code>MapRoute</code> is actually extension method in RouteCollectionExtensions.cs.
</p>
<a href="https://lh5.googleusercontent.com/-qvU8dVWiIpw/Tex-aJuc0RI/AAAAAAAAHdI/u3OgdJCf8EA/routecollection.png">
<img src="https://lh5.googleusercontent.com/-qvU8dVWiIpw/Tex-aJuc0RI/AAAAAAAAHdI/u3OgdJCf8EA/routecollection.png" alt="MVC register route"/>
</a>
<p>
Now, you can see how the route with particular URL is being register and associated with <code>MvcRouteHandler</code>.
</p>
<h2>Putting it all together</h2>
<p>
Now it is time to get deep breath and finally understand the route of HTTP request to MvcHttpHandler. Here we go:
</p>
<ul>
<li>ASP.NET framework starting to process incoming request in <code>ProcessRequest</code> method, but interesting stuff going in <code>ProcessRequestInternal</code></li>
<li><code>ProcessRequestInternal</code> calls <code>GetApplicationInstance</code> method that get application instance and calls it <code>Application_Init()</code></li>
<li><code>Application_Init()</code> registers routes that map URL (like &#8220;home/index&#8221;) with <code>MvcRouteHandler</code> instance</li>
<li>ASP.NET framework starts to iterate modules for incoming request and found <code>UrlRouting</code> module</li>
<li><code>UrlRouting</code> module matches incoming request URL with registered collections of Routes</li>
<li>For found matched Route it gets corresponding route handler (MvcRouteHandler)</li>
<li><code>MvcHandler</code> is being returned by GetHttpHandler of MvcRouteHandler</li>
</ul>
<p>
That&#8217;s the routing that is being executed each time you put URL and hit your browser button.
</p>
<h2>What&#8217;s next?</h2>
<p>
I hope next time we indeed look closer to <code>MvcHandler</code> :).
</p>
<p>
Previous: <a href="http://www.beletsky.net/2011/05/inside-aspnet-mvc-setting-up-project.html">Inside ASP.NET MVC: Part 2: Setting up project for hacking</a>
Next: <a href=http://www.beletsky.net/2011/06/inside-aspnet-mvc-all-begins-here.html">Inside ASP.NET MVC: All begins here - MvcHanlder</a>
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/05/inside-aspnet-mvc-setting-up-project.html">
    
      Inside ASP.NET MVC: Setting up project for hacking</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-05-29T19:58:00+02:00" pubdate data-updated="true">May 29<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/insidemvc/'>InsideMVC</a>, <a class='category' href='/blog/categories/mvc/'>MVC</a>, <a class='category' href='/blog/categories/asp-dot-net/'>asp.net</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>
As we <a href="http://www.beletsky.net/2011/05/inside-aspnet-mvc-part-1-packing-bags.html">already got</a> debug assembly and pdb file, it it time to create a test project that would be a sandbox for all experiments. This would be classic MVC application, but we going to substitute release version of MVC framework with our locally built version, which allows us easily debug it.
</p>
<h2>Create new project</h2>
<p>
Let&#8217;s create new project. It would be MVC 3 Application:
</p>
<!-- newproject.png -->
<a href="https://lh3.googleusercontent.com/-1wuOdUmqbUI/TeKIMTnbcUI/AAAAAAAAHcM/-kBRSXGB0bc/s720/newproject.png">
<img src="https://lh3.googleusercontent.com/-1wuOdUmqbUI/TeKIMTnbcUI/AAAAAAAAHcM/-kBRSXGB0bc/s720/newproject.png" alt="new project" />
</a>
<p>
On a second step just select &#8220;Empty&#8221; in &#8220;Select template&#8221; dialog. &#8220;Razor&#8221; would be for view engine.
</p>
<h2>Correct system.web assemblies section</h2>
<p>
Go to <code>web.config</code> of a new project and comment out <code>System.Web.Mvc</code> and <code>System.Web.WebPages</code> assemblies. By doing that we saying: &#8220;those 2 assemblies are no longer a part of compilation of our application&#8221;.
</p>
<!-- webconfig.png -->
<a href="https://lh3.googleusercontent.com/-Va0g0ltK6WE/TeKIMjzGltI/AAAAAAAAHcQ/dyR3mI2B1B4/webconfig.png">
<img src="https://lh3.googleusercontent.com/-Va0g0ltK6WE/TeKIMjzGltI/AAAAAAAAHcQ/dyR3mI2B1B4/webconfig.png" alt="web.config" />
</a>
<p>
<strong>UPDATE:</strong> If you do just that, later you will get an exception from Razor assemblies, about wrong type cast. To avoid that, it is even better to remove all assemblies in this section, plus Find/Replace PublicKeyToken=31bf3856ad364e35 to PublicKeyToken=null. That would do not make application to search GAC for missing assemblies and load locally built ones.
</p>
<h2>Correct application references</h2>
<p>
Now, remove existing references for <code>System.Web.Mvc</code> and <code>System.Web.WebPages</code> and put locally built ones instead. Right click on references project section and browse to the Debug folder of mvc3-rtm build directory. Try to build application now, it should be build without any issues.
</p>
<a href="https://lh4.googleusercontent.com/-ZxDsNTzlZ8w/TeKIMIG5lgI/AAAAAAAAHcE/f-RS0YrnwXM/addreferences.png">
<img src="https://lh4.googleusercontent.com/-ZxDsNTzlZ8w/TeKIMIG5lgI/AAAAAAAAHcE/f-RS0YrnwXM/addreferences.png" alt="setup" />
</a>
<h2>Home controller</h2>
<p>
Further steps are pretty simple, just add a test controller - <code>HomeController</code> with <code>Index</code> action. Add just a simple view for that.
</p>
<!-- controller.png -->
<a href="https://lh5.googleusercontent.com/-WMscnqODvIU/TeKIMHyuGBI/AAAAAAAAHcA/-3W-2nlB_RQ/controller.png">
<img src="https://lh5.googleusercontent.com/-WMscnqODvIU/TeKIMHyuGBI/AAAAAAAAHcA/-3W-2nlB_RQ/controller.png" alt="controller" />
</a>
<h2>Check it out!</h2>
<p>
Place a breakpoint into action method and press F5 to start debugger. Now you we&#8217;ve got a full stack trace that allows to see every aspect of MVC world.
</p>
<!-- stack.png -->
<a href="https://lh5.googleusercontent.com/-H0makF0CB_4/TeKIMbLt2bI/AAAAAAAAHcI/0nhnBobKnuA/stack.png">
<img src="https://lh5.googleusercontent.com/-H0makF0CB_4/TeKIMbLt2bI/AAAAAAAAHcI/0nhnBobKnuA/stack.png" alt="stack" />
</a>
<h2>Conclusion</h2>
<p>
The setup is easy and allows to jump in very quick. If you got any issues with that, please let me know.
</p>
<h2>
What is next?
</h2>
<p>
Next I will hack the entry point of MVC application called <code>MvcHandler</code> and understand how it works.
</p>
<p>
Please stay tuned.
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/05/inside-aspnet-mvc-part-1-packing-bags.html">
    
      Inside ASP.NET MVC: Packing bags for journey</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-05-25T21:57:00+02:00" pubdate data-updated="true">May 25<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/insidemvc/'>InsideMVC</a>, <a class='category' href='/blog/categories/mvc/'>MVC</a>, <a class='category' href='/blog/categories/asp-dot-net/'>asp.net</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>
I&#8217;m big fan of ASP.NET MVC framework. It is smart, clean and testable. A lot of stuff you can do with MVC are very intuitive, you don&#8217;t have to go thought pages of documentation to do some basic stuff. I do not use MVC on my primary work yet (unfortunately) but my small <a href="http://trackyt.net">project</a> became very nice sandbox to play around and learn stuff. 
</p>
<p>
I definitely learned something thought the year of hooked up with MVC. But feel I still miss a lot of details. Moreover, my hackers curiosity always force to look - &#8220;what is inside?&#8221;.
</p>
<p>
Great stuff about ASP.NET MVC project is that is open source. It is been released as open source and remain open source project till version 3.0.. In fact, it is very easy to start learning framework from inside! This what I&#8217;m going to do. I would like to go depth and hope that journey would be interesting and valuable.
</p>
<p>
Today I&#8217;ll to prepare everything I need for journey. I would be happy if you join me, so we would help each other along the way :).
</p>
<h2>Getting out source code</h2>
<p>
That&#8217;s easy. Just google for &#8220;MVC3 source code&#8221; and it would bring you directly to <a href="http://aspnet.codeplex.com/releases/view/58781">ASP.NET Codeplex</a> site.
</p>
<p>
Download <code>mvc3-rtm-sources.zip</code>. Unpack the archive and you will see the solution file <code>WebRuntime.sln</code> and 2 folders: <code>mvc3</code> and <code>webpages</code>. Layout of both folders are similar:
</p>
<pre>
    /--- bin
    /--- src
    /--- tests
    /--- tools
</pre>
<p>
Source code package is pretty much organized. Solution does not using NuGet, btw :)
</p>
<h2>Meet the solution</h2>
<p>
It&#8217;s time open up solution! Fire up Visual Studio and open <code>WebRuntime.sln</code>. Let the journey begins! 
</p>
<p>
Nothing fancy there. Minimal number of solution folders, just <code>MVC</code> and <code>WebPages</code>. Each of folder contains a bunch of projects in it. In nearest future we would be much interested in one <code>System.Web.Mvc</code> - heart of MVC framework.
</p>
<!-- solution.png -->
<a href="https://lh5.googleusercontent.com/_stL4bIIuRUs/Td1ccQNmpmI/AAAAAAAAHbI/9_D1bnR-u2U/solution.png">
<img src="https://lh5.googleusercontent.com/_stL4bIIuRUs/Td1ccQNmpmI/AAAAAAAAHbI/9_D1bnR-u2U/solution.png" alt="solution" />
</a>
<h2>Build it</h2>
<p>
Don&#8217;t waste any time and just build the solution. As it usually happened to me, with OSS projects - you always have some issues during build. It is not the case for MVC. Build runs smoothly as possible. The output is being placed in <code>mvc3/bin/debug</code> folder. So, as soon as build finished check it out and see for content.
</p>
<!-- output.png -->
<a href="https://lh4.googleusercontent.com/_stL4bIIuRUs/Td1dFx0z8wI/AAAAAAAAHbQ/2GGnooqDpVA/output.png">
<img src="https://lh4.googleusercontent.com/_stL4bIIuRUs/Td1dFx0z8wI/AAAAAAAAHbQ/2GGnooqDpVA/output.png" alt="output" />
</a>
<h2>Run tests</h2>
<p>
All TDD lovers would be really pleased with a number of tests in solution. There is 5004 tests actually, solid number of tests. No surprise <code>MsTest</code> framework is used. Let&#8217;s just try to run them!
</p>
<p>
In menu Test -> Run -> Tests in Current Context. Here we go.. It took a bit time to run all. I was a little disappointed to see that some tests are failing.
</p>
<p>
I did an inspection of failures and found out that all of them are actually related to my Local Settings. I use &#8220;Ukrainian Locale&#8221; that means time format, decimal point symbol etc. are differs from &#8220;United States Local&#8221;. It&#8217;s a quite common issue of units, workaround could be a simply change your locale to the one that rest development team uses. The rests of tests run&#8217;s just fine!
</p>
<!-- tests.png -->
<a href="https://lh5.googleusercontent.com/_stL4bIIuRUs/Td1dGBUDDoI/AAAAAAAAHbY/0Lqffzp4lLA/tests.png">
<img src="https://lh5.googleusercontent.com/_stL4bIIuRUs/Td1dGBUDDoI/AAAAAAAAHbY/0Lqffzp4lLA/tests.png" alt="tests" />
</a>
<h2>Conclusions</h2>
<p>
So, my initial impression are: 
</p>
<ul>
<li>Easy to build and start up</li>
<li>Code looks really nice</li>
<li>Code style a little differs from default C# especially in with &#8220;{&#8221;</li>
<!-- code.png -->
<a href="https://lh4.googleusercontent.com/_stL4bIIuRUs/Td1dFxvjw5I/AAAAAAAAHbU/MvOwune0ItA/code.png">
<img src="https://lh4.googleusercontent.com/_stL4bIIuRUs/Td1dFxvjw5I/AAAAAAAAHbU/MvOwune0ItA/code.png" alt="code"/>
</a>
<li>Tests following AAA pattern really nicely</li>
<!-- test.png -->
<a href="https://lh4.googleusercontent.com/_stL4bIIuRUs/Td1dGNxu8NI/AAAAAAAAHbc/yTr-v0_oCww/test.png">
<img src="https://lh4.googleusercontent.com/_stL4bIIuRUs/Td1dGNxu8NI/AAAAAAAAHbc/yTr-v0_oCww/test.png" alt="test" />
</a>
<li>Code contracts are not used, but code pretty defensive with check for <code>null</code> arguments etc.</li>
<!-- exception.png -->
<a href="https://lh6.googleusercontent.com/_stL4bIIuRUs/Td1dF7ZxCuI/AAAAAAAAHbM/7IORamYJ-fA/exception.png">
<img src="https://lh6.googleusercontent.com/_stL4bIIuRUs/Td1dF7ZxCuI/AAAAAAAAHbM/7IORamYJ-fA/exception.png" alt="exception" />
</a>
<li>All members are with &#8220;_&#8221; underscore - I like that :)</li>
<li>Methods are small and clean</li>
</ul>
<p>
What I don&#8217;t like to far:
</p>
<ul>
<li>Solution is quite big - I would be happy to have separation between MVC part and WebPages (if it is possible)</li>
<li>Tests are really slow. Suite run for 3-4 minutes (upd: I blame MsTest runner for that, with TD.NET all tests passed for 89 sec&#8217;s)</li>
<li>Already found some comments that lie (one more point to try to avoid comments if possible)</li>
</ul>
<h2>
What is next?
</h2>
<p>
Next, I will setup a test project which allow us to fully get in deep of details and see how it work.
</p>
<p>
Please stay tuned.
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/05/net-saturday-in-ciklum.html">
    
      .NET Saturday in Ciklum</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-05-14T20:19:00+02:00" pubdate data-updated="true">May 14<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/conference/'>Conference</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>
This Saturday it was really nice event organized and hosted by <a href="http://www.ciklum.net/">Ciklum</a>. I had a big pleasure to be part of the event and was given a speech about Continues Production (Delivery) and my experience of using UppercuT, RoundhouE and Jenkinks for that. 
</p>
<img style="position: relative; display: inline; float: left; " src="https://lh6.googleusercontent.com/_stL4bIIuRUs/Tc68_M3LaaI/AAAAAAAAHaM/TrFD0GQgQq0/IMG_4956.JPG" />
<p>
The organization of event was really nice. Only the speakers were one who introduced disorder there :). Some speeches were bit longer than planned, that&#8217;s why schedule ruined from the very beginning of event. My speech was planned for 0.5 hour, but I&#8217;ve been 1 hour on stage.
</p>
<p>
I&#8217;ve been pretty nervous since I never gave public speeches, but I really liked that experience. I hope to visit/participate more .NET events in future. At the end I was happy that everything is alright and I&#8217;m finally done. So, in great mood and relaxed I stayed to listen for the rest of speakers.
</p>
<p>
Also I was really nice to meet <a href="http://twitter.com/#!/skalinets">Sergey Kalinets</a>, <a href="http://twitter.com/#!/antonvidishchev">Anton Vidishchev</a> who shared their experience in TDD and ASP.net MVC framework. Such type of event are really great for professionals gathering, helping to better communication and knowledge sharing. 
</p>
<p>
Let me wish Ciklum and Inna Tueva in particular to have will and energy for organizing such events. Thanks a lot!
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/05/continuous-production-make-it-work.html">
    
      Continuous Delivery: Make it work</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-05-11T09:27:00+02:00" pubdate data-updated="true">May 11<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/continuous/'>Continuous</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>
As soon as we <a href="http://www.beletsky.net/2011/05/continues-production-setup-and-run.html">setup</a> project infrastructure in a way that build and deploy is done by one batch command, we are ready to run this process continuously. It is possible to take any CI server you want, I stopped on <a href="http://jenkins-ci.org/">Jenkins</a>.. basically it contains everything I need. But before start with Jenkins, let&#8217;s one more time take a look current infrastructure and goals.
</p>
<h2>Git branching model</h2>
<p>
There is great <a href="http://nvie.com/posts/a-successful-git-branching-model">article</a> on that topic, I used main ideas from that. So, I have 2 branches in my <code>origin</code> that exists all the time. They are: <code>master</code> and <code>development</code>. All pushes I do during implementation are going to <code>development</code> branch. No direct pushes are made to <code>master</code> at all (there are some exceptions of cause, but I try to follow that rule). As soon as code in <code>development</code> is stabilized, I prepare special <code>release</code> branch (update version and small clean up there) and <code>release</code> is being merged to <code>master</code> as it tested and everything is fine.
</p>
<h2>Staging and Production environments</h2>
<p>
I define 2 types of environments: Staging and Production. Environment includes: binaries, markup, database, deploy scripts.
</p>
<p>Everything that is being developed are goes to staging environment immediately (and automatically). Production update is being run manually as soon as all testing on Staging are finished. Separation of environments is great idea. Even if we are trying hard to have potentially shippable software during each build, this is not true. It is usually a lot of problems in latest version that need to be fixed before production server update.
</p>
<p>
So, Staging is a result of build/deploy of <code>development</code>; Production is a result of build/deploy of <code>master</code>.
</p>
<p>
In my case, everything you see <a href="http://stage.trackyt.net/">here</a> is a result of build of <a href="https://github.com/alexbeletsky/trackyt.net/tree/development">this</a>. Everything you see <a href="http://www.trackyt.net/">here</a> is a result of <a href="https://github.com/alexbeletsky/trackyt.net">this</a>.
</p>
<h2>What I want to get?</h2>
<p>
I want to have automatic system that would update my <a href="http://stage.trackyt.net/">Staging</a> with every push to <code>development</code> branch and I want automatic system that would update my <a href="http://www.trackyt.net/">Production</a> as soon as <code>master</code> branch is ready to. As it said in <a href="http://www.beletsky.net/2011/04/continues-production-overview-and.html">overview</a> having such system is great reduce of deployment overhead. Let&#8217;s make this happen!
</p>
<p>
As I said earlier I would use <a href="http://jenkins-ci.org/">Jenkins</a>. Great stuff about this software that is very intuitive! Setup is easy and fun, I would put just a little guidance of process.
</p>
<h2>Local Jenkins server setup</h2>
<p>
As you download Jenkins WAR file, it is easy to start just with <code>java -jar jenkins.war</code>. Now, the dashboard is available at <code>http://localhost:8080/</code>.
</p>
<h3>Plugins</h3>
<p>
First, you should add all required plugins. It already contains some, but some are missing. I&#8217;ve add such to my default configuration:
</p>
<ul>
<li><a href="http://wiki.jenkins-ci.org/display/JENKINS/Git+Plugin">Jenkins GIT plugin</a></li>
<li><a href="http://wiki.jenkins-ci.org/display/JENKINS/Github+Plugin">Github plugin</a></li>
<li><a href="http://wiki.jenkins-ci.org/display/JENKINS/NUnit+Plugin">NUnit Plugin</a></li>
</ul>
<p>
Go to &#8220;Manage Jenkins&#8221; -> &#8220;Manage Plugins&#8221; and install missing one.
</p>
<p>
So, my configuration looks like this:
</p>
<!-- plugins.png -->
<img src="https://lh6.googleusercontent.com/_stL4bIIuRUs/Tco7BUnOiGI/AAAAAAAAHZk/XSxs5Y_zrR0/plugins.png" alt="plugins" />
<h3>Configure system</h3>
<p>
Now go to &#8220;Manage Jenkins&#8221; -> &#8220;Configure System&#8221; and find &#8220;Git&#8221; section there. You should provide with your user name and path to Git. I have git in my PATH variable (recommend you do the same).
</p>
<h3>Create new job</h3>
<p>
After basic configuration is done, let&#8217;s define new job. Go to &#8220;New job&#8221;. In common section you should give your job name and provide with githib path to repository.
</p>
<img src="https://lh5.googleusercontent.com/_stL4bIIuRUs/Tco7A-XTqYI/AAAAAAAAHZg/0kLPsWXWj6k/common-section.png" alt="common section" />
<p>
In Source Control Management: URL to Git repository, Branch to build and Repository browser (optional).
</p>
<!-- SCM.png -->
<img src="https://lh6.googleusercontent.com/_stL4bIIuRUs/Tco7Bh2RuUI/AAAAAAAAHZs/p568dcfUStk/SCM.png" alt="SCM" />
<p>
Build triggers (explain a bit later).
</p>
<!-- build-triggers.png -->
<img src="https://lh4.googleusercontent.com/_stL4bIIuRUs/Tco7A6XC3ZI/AAAAAAAAHZY/X39bPBs9U3Q/build-triggers.png" alt="build-triggers" />
<p>
In Build section you specify commands to build/test/package and to deploy results. See my <a href="http://www.beletsky.net/2011/05/continues-production-setup-and-run.html">previous post</a> for details.
</p>
<!-- build.png -->
<img src="https://lh4.googleusercontent.com/_stL4bIIuRUs/Tco7A76md_I/AAAAAAAAHZc/5JPyCIL5Pek/build.png" alt="build" />
<p>
Finally in Post-build section, specify path to grab artifacts.
</p>
<!-- post-build.png -->
<h3>Test it locally</h3>
<p>
As soon as configuration is done, you can test your build locally. Just start your job and make sure that: build run, tests executed, new database deployed, new application deployed. Basically if everything done correctly in previous <a href="http://www.beletsky.net/2011/05/continues-production-setup-and-run.html">steps</a> you should not experience any troubles. If it is fine that means the configuration is simply ready to be put to production server.
</p>
<h2>Move it to production</h2>
<p>
As it defined, our goal is to update staging and production with out any manual work. The simplest scenario then CI server resides on the same machine as production server.
</p>
<p>
Great thing about Jenkins is that it requires no installation. So, I packed all content of <code>~/User/Jenkins</code> folder and Git into one single package and FTP&#8217;ed to my production server. As you unpack, configure Git in PATH variable, setup up your private repository keys it is just simply ready to work. Now, test it remotely - staging and production should be able to update with one single click on Jenkins dashboard.
</p>
<h3>Little adjustments for production server</h3>
<p>
My VPS has Windows auto-update enabled, so It is being rebooted from time to time. As it is being rebooted, you should start Jenkins manually. Fortunately it has really nice feature - Jenkins might be run as <a href="https://wiki.jenkins-ci.org/display/JENKINS/Installing+Jenkins+as+a+Windows+service">Windows Service</a>. This is extremely useful, I recommend to do it from very beginning.
</p>
<h3>Using Github hook to automate build run</h3>
<p>
I want my every commit to <code>development</code> to be tested and to be visible on Stage. As it said in <strong>Configure system</strong> part, you can setup build triggers. With build trigger you can run build just by requesting this URL <code>http://jenkins.server/jobname/build?token=TOKEN</code>.
</p>
<p>
In github repository go to Admin section and setup new hook in &#8220;Post Recieve URLs&#8221; section, like this:
</p>
<!-- gtihub -->
<img src="https://lh4.googleusercontent.com/_stL4bIIuRUs/TcpDr67qBpI/AAAAAAAAHZ4/bL1s9Lwhh7g/s912/github.png" alt="github" />
<p>
This concludes the setup.
</p>
<h2>Control your builds all the time</h2>
<p>
What we did is only very basic setup, but it already gives a lot of power. It is really easy to track all builds/artifacts/history of changes. Downtime of site is extreamly slow (comparing to manual changes). Dashboard is very convenient to control builds:
</p>
<!-- dashboard -->
<img src="https://lh6.googleusercontent.com/_stL4bIIuRUs/TcpEsDXvmmI/AAAAAAAAHZ8/c7ttFDLm_fA/s912/dashboard.png" alt="dashboard" /></div>

      
      
    </div>
  </div>

    </article>
  
  <div class="pagination inner pure-u-1">
    
      <a class="prev" href="/blog/page/16/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/14/">Newer &rarr;</a>
    
  </div>
</div></div>
	<footer class="pure-g-r"><div class="inner pure-u-1">
	<p>
		Theme by <a href="https://twitter.com/alexbeletsky">@alexbeletsky</a> | Fonts by <a href="http://www.google.com/fonts/">Google Fonts</a> | Icons by <a href="http://fontello.com/">Fontello</a> | Hosted on <a href="http://github.com">github</a> | Powered by <a href="http://octopress.org/">Octopress</a>
	</p>
	<p>
		Copyright © 2010 - 2018 beletsky.net
	</p>
</div>

</footer>
	<div class="buttons">
	


	
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>


	
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>


	
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


	

</div>
</body>
</html>
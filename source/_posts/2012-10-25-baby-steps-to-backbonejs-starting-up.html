---
layout: post
title: "Baby Steps to Backbone.js: Starting up"
date: 2012-10-25T22:40:00+03:00
comments: false
categories:
 - JavaScript
 - Backbone.js
 - BabyStepsBackbone
---

<div class='post'>
    <p>Many times then I speak to people regarding usage of any kind of MV* frameworks on front-end I hear common objection: "but we already have a lot of code written on jQuery/Dojo/Whatever, I think usage of additional framework would be impossible". This is not actually true. Backbone is very lightweight and could fit into any existing application.<br />
</p><p>Baby steps strategy is the most efficient way of trying the things. You start with something really small, enhance it over the time and expand for other application areas. Now, let's imagine you got an existing application, you wish to start using Backbone.js to improve that. I would like to show you, that it's absolutely possible.<br />
</p><p>Suppose, you want to add a feedback form for your app. Let's implement that with Backbone.js.<br />
</p><h2>Applications, Models, Views</h2><p>There are no such thing as `Controller` in Backbone.js. But you have to have some kind of entry point, some place with `main()` function inside. I got used to call this place - Application. Basically, the application is a module, which is responsible for initialization of model, instantiation of view, rendering the view.<br />
</p><p>The `Model` is object that holds the data. It could be fetched and persisted back to server.<br />
</p><p>And finally view is object that produces markup, hooking up events and updates View from data in Model and otherwise.<br />
</p><p>We are going to create all three things. It makes a lot of sense to breakdown the folder structure of to reflect logical meaning of each entity of Backbone application. So, we'll create 3 folders for apps, models and views.<br />
</p><a href="https://lh5.googleusercontent.com/-aFNqz_2e_i4/UImU8WZaMEI/AAAAAAAAKZ0/-v-Jb5EttRY/s620/image-1.png"><br />
<img src="https://lh5.googleusercontent.com/-aFNqz_2e_i4/UImU8WZaMEI/AAAAAAAAKZ0/-v-Jb5EttRY/s620/image-1.png"/><br />
</a><br />
<h2>Setup Backbone.js</h2><p>On a target html page we should place 2 additional script tags.<br />
</p><pre class="brush: html">&lt;script src=&quot;/scripts/libs/underscore.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;/scripts/libs/backbone.js&quot;&gt;&lt;/script&gt;
    </pre><p>Besides of that, let's add one more div. The one that application will be using for rendering views.<br />
</p><pre class="brush: html">&lt;div id=&quot;app&quot; class=&quot;container&quot;&gt;&lt;/div&gt;
    </pre><h2>Application entry point</h2><p>Let's create a new file in `apps` folder and call it `FeedbackFormApp.js`. It would be very simple.<br />
</p><pre class="brush: js">$(function () {
    var model = new Feedback();
    var view = new FeedbackFormView ({model: model});
    
    $('#app').html(view.render().el);
});
    </pre><p>Then DOM is ready, we instantiate new model object and view and render the form into DOM element with id - app.<br />
</p><h2>Feedback model</h2><p>Now, let's define a model. Create a new file in models folder and call it `Feedback.js`.<br />
</p><p>The model refects the data we are collecting/displaying to user and it's typically stored on server (sometimes on localstorage). Feedback model will include 3 attributes: email of user, his web site and the feedback text. In terms of Backbone.js that would mean.<br />
</p><pre class="brush: js">var Feedback = Backbone.Model.extend({

    url: '/feedback',

    defaults: {
        'email': '',
        'website': '',
        'feedback': ''
    }

});
    </pre><p>The <code>url</code> property of model object is used by Backbone for persisting object to server. The <code>default</code> are defaults values for model attributes.<br />
</p><h2>Rendering the view</h2><p>The most interesting things in Backbone.js app is happening in Views. Add new file to `views` folder - FeedbackView.js.<br />
</p><p>The skeleton of view would look like this:<br />
</p><pre class="brush: js">var FeedbackFormView = Backbone.View.extend({
   className: 'row',

    render: function () {
        return this;
    }
});
    </pre><p>This view, does do nothing. So, let make it render the template. The template would be very simple form.<br />
</p><p>There are different approaches, there to actually place the markup. It's possible to place it in the same .html file where view starts and extract it by jQuery, it's possible to place to separate file and load it asynchronously by $.get(). But, according to baby steps scenario - we'll place it directly to .js file. So, inside the view we'll add property called template.<br />
</p><pre class="brush: js">template: '\
 &lt;form&gt;\
  &lt;legend&gt;Share the feedback&lt;/legend&gt;\
  &lt;div class=&quot;control-group&quot;&gt;\
   &lt;label&gt;Email&lt;/label&gt;\
   &lt;input type=&quot;text&quot; id=&quot;email&quot; placeholder=&quot;Your email address...&quot;&gt;\
  &lt;/div&gt;\
  &lt;div class=&quot;control-group&quot;&gt;\
   &lt;label&gt;Web site&lt;/label&gt;\
   &lt;input type=&quot;text&quot; id=&quot;website&quot; placeholder=&quot;Your website...&quot;&gt;\
  &lt;/div&gt;\
  &lt;div class=&quot;control-group&quot;&gt;\
  &lt;label&gt;Feedback&lt;/label&gt;\
  &lt;textarea id=&quot;feedback&quot; class=&quot;input-xxlarge&quot; placeholder=&quot;Feedback text...&quot; rows=&quot;6&quot;&gt;&lt;/textarea&gt;\
  &lt;/div&gt;\
  &lt;button type=&quot;submit&quot; id=&quot;submit&quot; class=&quot;btn&quot;&gt;Submit&lt;/button&gt;\
 &lt;/form&gt;\
',
    </pre><p>And render method, would be:<br />
</p><pre class="brush: js">render: function () {
    this.$el.html(this.template);

    return this;
}
    </pre><h2>First test</h2><p>Basically, we are ready to see some results. Modify the target view by adding references to model and view.<br />
</p><pre class="brush: html">&lt;script src=&quot;/scripts/src/models/Feedback.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;/scripts/src/views/FeedbackFormView.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;/scripts/src/apps/FeedbackFormApp.js&quot;&gt;&lt;/script&gt;
    </pre><p>Fire up the application and go to target page. You should be able to see something like this (for styles I use <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a> here).<br />
</p><a href="https://lh5.googleusercontent.com/-asgv034ZUyA/UImU8iURcEI/AAAAAAAAKZ4/9Yga2hCy9TQ/s620/image-2.png"><br />
<img src="https://lh5.googleusercontent.com/-asgv034ZUyA/UImU8iURcEI/AAAAAAAAKZ4/9Yga2hCy9TQ/s620/image-2.png"/><br />
</a><br />
<p>If you see the form on screen, it means application started properly.<br />
</p><h2>Submitting the form</h2><p>We enter the data into input fields and as soon as data is in-place we are ready to submit. It means we have to catch an event of `Submit` button click and store the model to server.<br />
</p><p>To explain to Backbone.js that you interested in particular DOM event, you need to add another property to view. It is called <code>events</code>.<br />
</p><pre class="brush: js">events: {
    'click #submit': 'submitClicked'
},
    </pre><p>You can read it as - if click happed to element with id `submit`, call function submitClicked.<br />
</p><pre class="brush: js">submitClicked: function (e) {
    e.preventDefault();

    var options = {
        success: function () {
            alert('Thanks for the feedback!');
        },
        error: function () {
            alert('Opps, your feedback has not been submitted, please try again.');
        }
    };

    var feedback = {
        email: this.$('#email').val(),
        website:  this.$('#website').val(),
        feedback: this.$('#feedback').val()
    };

    this.model.save(feedback, options);
}
</pre><p>What it does, is first of all prevent the default behavior of event. So, the form would not be actually posted to server. Second, it prepares the options object's with success and error handlers. After we initialize all attributes with actual values from corresponding inputs/textbox. And finally we call model.save().<br />
</p><h2>Second test</h2><p>Fire up application again. Now, if have properly set-up server side to receive the HTTP post call to `/feedback` you actually post first feedback.<br />
</p><a href="https://lh5.googleusercontent.com/-xoKGopfbwlw/UImU8rspz_I/AAAAAAAAKZ8/8D3bgfnRpgE/s620/image-3.png"><br />
<img src="https://lh5.googleusercontent.com/-xoKGopfbwlw/UImU8rspz_I/AAAAAAAAKZ8/8D3bgfnRpgE/s620/image-3.png"/><br />
</a><br />
<p>From my server trace, I can see that new object is received.<br />
</p><a href="https://lh6.googleusercontent.com/-FPoQZTARH0g/UImU9HR4aHI/AAAAAAAAKaA/fhPj64h6cr8/s621/image-4.png"><br />
<img src="https://lh6.googleusercontent.com/-FPoQZTARH0g/UImU9HR4aHI/AAAAAAAAKaA/fhPj64h6cr8/s621/image-4.png"/><br />
</a><br />
<p>Now, it's the server job to put to storage, allocate the id etc.<br />
</p><h2>Conclusions</h2><p>In this first baby step, I just showed how it's possible to adopt Backbone.js for existing apps. It does not make a lot of sense to re-write your existing code with Backbone.js, but new widgets/elements/applications could be created with Backbone, having a benefit of it's structural approach.<br />
</p><p>I'll go on with baby steps, showing other features of Backbone.js.<br />
</p></div>
